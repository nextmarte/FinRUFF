[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Sejam bem vindos √† disciplina de Finan√ßas com R - an√°lise e otimiza√ß√£o de carteiras. Neste curso, vamos aprender a utilizar a linguagem de programa√ß√£o R para an√°lise de dados financeiros e otimiza√ß√£o de carteiras de investimento. Se este √© o seu primeiro contato com a linguagem R, n√£o se preocupe! Vamos come√ßar do zero e aprender juntos, na pr√°tica.\n\n\n\n\n\n\nVoc√™ n√£o precisar√° instalar nada no seu computador, mas caso queira, um guia do passo a passo para tal ser√° disponibilizado oportunamente.\n\n\n\n\n\n\nO curso √© dividido em duas aulas:\n\nAula 1:\n\nApresenta√ß√£o do curso\nIntrodu√ß√£o ao RStudio\nIntrodu√ß√£o √† programa√ß√£o no R\n\nObjetos, tipos de vari√°veis e opera√ß√µes\n\nFinan√ßas com R\n\nObten√ß√£o de dados financeiros\nManipula√ß√£o e visualiza√ß√£o de dados\n\n\nAula 2:\n\nRevis√£o da aula anterior\nRisco\nOtimiza√ß√£o de carteiras\nDashboards com Quarto"
  },
  {
    "objectID": "index.html#bem-vindos",
    "href": "index.html#bem-vindos",
    "title": "",
    "section": "",
    "text": "Sejam bem vindos √† disciplina de Finan√ßas com R - an√°lise e otimiza√ß√£o de carteiras. Neste curso, vamos aprender a utilizar a linguagem de programa√ß√£o R para an√°lise de dados financeiros e otimiza√ß√£o de carteiras de investimento. Se este √© o seu primeiro contato com a linguagem R, n√£o se preocupe! Vamos come√ßar do zero e aprender juntos, na pr√°tica.\n\n\n\n\n\n\nVoc√™ n√£o precisar√° instalar nada no seu computador, mas caso queira, um guia do passo a passo para tal ser√° disponibilizado oportunamente.\n\n\n\n\n\n\nO curso √© dividido em duas aulas:\n\nAula 1:\n\nApresenta√ß√£o do curso\nIntrodu√ß√£o ao RStudio\nIntrodu√ß√£o √† programa√ß√£o no R\n\nObjetos, tipos de vari√°veis e opera√ß√µes\n\nFinan√ßas com R\n\nObten√ß√£o de dados financeiros\nManipula√ß√£o e visualiza√ß√£o de dados\n\n\nAula 2:\n\nRevis√£o da aula anterior\nRisco\nOtimiza√ß√£o de carteiras\nDashboards com Quarto"
  },
  {
    "objectID": "index.html#refer√™ncias",
    "href": "index.html#refer√™ncias",
    "title": "",
    "section": "Refer√™ncias",
    "text": "Refer√™ncias\n\nhttps://posit.cloud/: Plataforma em nuvem para desenvolvimento colaborativo de projetos em R e Python.\nhttps://uff-adm.notion.site/Instala-o-b5969aeda52045289c52db8fd833c6b3: Guia de instala√ß√£o do R e RStudio.\nhttps://ser.uff.br/: Semin√°rio internacional de estat√≠stica com R.\nhttps://latin-r.com/pt/: Site da confer√™ncia LatinR, um evento sobre o uso da linguagem R na Am√©rica Latina.\nhttps://r4ds.had.co.nz/index.html: Livro online ‚ÄúR for Data Science‚Äù, um guia completo para aprender a usar o R para an√°lise de dados.\nhttps://cienciadedatos.github.io/pt-r4ds/: Tradu√ß√£o para o portugu√™s do livro ‚ÄúR for Data Science‚Äù feita pela comunidade Brasileira de R.\nhttps://cran.r-project.org/: Reposit√≥rio oficial de pacotes da linguagem R.\nhttps://marcusramalho.tech/RinVSCode/: Tutorial do professor Marcus Ramalho sobre como usar o R no Visual Studio Code.\nhttps://github.com/nextmarte: Perfil do GitHub do professor Marcus Ramalho.\nhttps://posit.co/download/rstudio-desktop/: P√°gina para download do RStudio Desktop, um ambiente de desenvolvimento integrado para a linguagem R.\nhttps://quarto.org/: Site do Quarto, uma ferramenta de c√≥digo aberto para cria√ß√£o de documentos cient√≠ficos e t√©cnicos.\nhttps://rpubs.com/Sergio_Garcia/intermediate_portfolio_analysis_r - Intermediate to Portfolio Analysis in R"
  },
  {
    "objectID": "aula_2.html",
    "href": "aula_2.html",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "",
    "text": "Risco: Probabilidade de um resultado adverso em rela√ß√£o ao esperado."
  },
  {
    "objectID": "aula_2.html#relembrando-alguns-conceitos-sobre-risco",
    "href": "aula_2.html#relembrando-alguns-conceitos-sobre-risco",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "",
    "text": "Risco: Probabilidade de um resultado adverso em rela√ß√£o ao esperado."
  },
  {
    "objectID": "aula_2.html#tipos-de-risco",
    "href": "aula_2.html#tipos-de-risco",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Tipos de risco",
    "text": "Tipos de risco\n\nRisco conhecido: Distribui√ß√£o de probabilidade do evento √© conhecida (ex: falha de motor).\nIncerteza: Distribui√ß√£o de probabilidade desconhecida ou imprevis√≠vel (ex: crise econ√¥mica)."
  },
  {
    "objectID": "aula_2.html#atitudes-frente-ao-risco",
    "href": "aula_2.html#atitudes-frente-ao-risco",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Atitudes frente ao risco",
    "text": "Atitudes frente ao risco\n\nAvers√£o: Prefere menor risco para mesmo retorno.\nIndiferen√ßa: N√£o se importa com o risco.\nPropens√£o: Aceita maior risco por potencial de maior retorno.\n\n\nO participante de uma ap√≥lice de seguros t√™m que predisposi√ß√£o frente ao risco?\nE a companhia de seguros?"
  },
  {
    "objectID": "aula_2.html#mensura√ß√£o-do-risco",
    "href": "aula_2.html#mensura√ß√£o-do-risco",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Mensura√ß√£o do Risco",
    "text": "Mensura√ß√£o do Risco\n\nDesvio padr√£o (œÉ): Mede a dispers√£o dos resultados em torno da m√©dia.\nCoeficiente de varia√ß√£o (CV): Mede o risco por unidade de retorno (œÉ / retorno m√©dio)."
  },
  {
    "objectID": "aula_2.html#risco-de-carteira",
    "href": "aula_2.html#risco-de-carteira",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Risco de Carteira",
    "text": "Risco de Carteira\n\nCovari√¢ncia: Mede a rela√ß√£o entre os retornos de dois ativos.\nDiversifica√ß√£o: Reduz o risco total da carteira ao combinar ativos com diferentes riscos (Markowitz, 1952) - ‚ÄúN√£o colocar todos os ovos na mesma cesta‚Äù."
  },
  {
    "objectID": "aula_2.html#risco-individual-vs.-sist√™mico",
    "href": "aula_2.html#risco-individual-vs.-sist√™mico",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Risco individual vs.¬†sist√™mico",
    "text": "Risco individual vs.¬†sist√™mico\n\nIndividual: Espec√≠fico de cada ativo.\nSist√™mico: Afeta todo o mercado."
  },
  {
    "objectID": "aula_2.html#√≠ndice-sharpe-is",
    "href": "aula_2.html#√≠ndice-sharpe-is",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "√çndice Sharpe (IS)",
    "text": "√çndice Sharpe (IS)\n\nDefini√ß√£o: Mede o retorno adicional por unidade de risco em rela√ß√£o √† taxa livre de risco.\nF√≥rmula: IS = (Retorno m√©dio do portf√≥lio - Taxa livre de risco) / Desvio padr√£o do excesso de retorno.\ninterpreta√ß√£o: IS &gt; 1: Retorno adicional por unidade de risco; IS &lt; 1: Retorno insuficiente por unidade de risco. Quantos mais alto o √≠ndice, melhor."
  },
  {
    "objectID": "aula_2.html#beta-Œ≤",
    "href": "aula_2.html#beta-Œ≤",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Beta (Œ≤)",
    "text": "Beta (Œ≤)\n\nDefini√ß√£o: Mede a sensibilidade do retorno de um ativo em rela√ß√£o ao retorno do mercado.\nF√≥rmula: Œ≤ = Cov(Ri, Rm) / Var(Rm).\nInterpreta√ß√£o: Œ≤ &gt; 1: Ativo mais vol√°til que o mercado; Œ≤ &lt; 1: Ativo menos vol√°til que o mercado.\nExemplo: Se Œ≤ = 1, o ativo se move na mesma dire√ß√£o que o mercado."
  },
  {
    "objectID": "aula_2.html#alfa-Œ±",
    "href": "aula_2.html#alfa-Œ±",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Alfa (Œ±)",
    "text": "Alfa (Œ±)\n\nDefini√ß√£o: Mede o retorno adicional de um ativo em rela√ß√£o ao retorno esperado com base no risco.\nF√≥rmula: Œ± = Retorno do ativo - (Taxa livre de risco + Œ≤ * (Retorno do mercado - Taxa livre de risco)).\nInterpreta√ß√£o: Œ± &gt; 0: Ativo superou o retorno esperado; Œ± &lt; 0: Ativo ficou aqu√©m do retorno esperado.\nExemplo: Se Œ± = 0, o ativo teve o retorno esperado com base no risco.\nObserva√ß√£o: O alfa √© uma medida de desempenho ajustada ao risco."
  },
  {
    "objectID": "aula_2.html#fun√ß√£o-de-utilidade-quadr√°tica",
    "href": "aula_2.html#fun√ß√£o-de-utilidade-quadr√°tica",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Fun√ß√£o de utilidade quadr√°tica",
    "text": "Fun√ß√£o de utilidade quadr√°tica\nA fun√ß√£o de utilidade quadr√°tica √© usada na otimiza√ß√£o de portf√≥lios para encontrar a aloca√ß√£o de ativos que maximiza o retorno esperado e minimiza o risco. A fun√ß√£o de utilidade quadr√°tica √© dada por:\n\\(U = \\mu^T w - \\lambda \\sigma^2\\)\nonde:\n\n\\(U\\) √© a fun√ß√£o de utilidade\n\\(\\mu^T\\) √© o vetor de retornos esperados\n\\(w\\) √© o vetor de pesos dos ativos\n\\(\\lambda\\) √© o fator de avers√£o ao risco\n\ngeneralizando para o caso de \\(n\\) ativos, a fun√ß√£o de utilidade quadr√°tica √© dada por:\n\\(U = \\mu^T w - \\lambda w^T \\Sigma w\\)\nonde:\n\n\\(\\Sigma w\\) √© a matriz de covari√¢ncia dos retornos dos ativos\n\\(w^T\\) √© o vetor transposto de pesos dos ativos\n\\(w\\) √© o vetor de pesos dos ativos\n\\(\\lambda\\) √© o fator de avers√£o ao risco\n\\(\\mu\\) √© o vetor de retornos esperados\n\\(U\\) √© a fun√ß√£o de utilidade"
  },
  {
    "objectID": "aula_2.html#otimiza√ß√£o-de-portf√≥lios",
    "href": "aula_2.html#otimiza√ß√£o-de-portf√≥lios",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Otimiza√ß√£o de portf√≥lios",
    "text": "Otimiza√ß√£o de portf√≥lios\nA otimiza√ß√£o de portf√≥lios √© um problema de maximiza√ß√£o da fun√ß√£o de utilidade quadr√°tica sujeita a restri√ß√µes, como a soma dos pesos dos ativos deve ser igual a 1 e os pesos dos ativos devem ser maiores ou iguais a zero."
  },
  {
    "objectID": "aula_2.html#primeiro-vamos-carregar-os-pacotes-necess√°rios",
    "href": "aula_2.html#primeiro-vamos-carregar-os-pacotes-necess√°rios",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Primeiro vamos carregar os pacotes necess√°rios",
    "text": "Primeiro vamos carregar os pacotes necess√°rios"
  },
  {
    "objectID": "aula_2.html#ativos-selecionados",
    "href": "aula_2.html#ativos-selecionados",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Ativos selecionados",
    "text": "Ativos selecionados\n\n# Ativos selecionados\n\ntickers &lt;- c(\"VALE3.SA\",\"PETR4.SA\",\"AZUL4.SA\",\"MGLU3.SA\", \"CMIG4.SA\")\n\nprices &lt;- \n  getSymbols(tickers, \n             src = 'yahoo', \n             from = \"2019-05-30\",\n             to = \"2024-05-30\",\n             auto.assign = TRUE, #obs auto asign carrega os resultados para o ambiente\n             warnings = FALSE,) %&gt;% \n  map(~Ad(get(.))) %&gt;% \n  reduce(merge) %&gt;%\n  `colnames&lt;-`(tickers)"
  },
  {
    "objectID": "aula_2.html#baixando-os-pre√ßos-do-benchmark",
    "href": "aula_2.html#baixando-os-pre√ßos-do-benchmark",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Baixando os pre√ßos do benchmark",
    "text": "Baixando os pre√ßos do benchmark\n\n# Baixando os pre√ßos do IBOV\n\nibov &lt;- getSymbols(\"^BVSP\", \n                   src = 'yahoo', \n                   from = \"2019-05-30\",\n                   to = \"2024-05-30\",\n                   auto.assign = TRUE, \n                   warnings = FALSE) %&gt;% \n  map(~Ad(get(.))) %&gt;% \n  reduce(merge) %&gt;% \n  `colnames&lt;-`(\"IBOV\")\n\nhead(ibov)\n\n            IBOV\n2019-05-30 97457\n2019-05-31 97030\n2019-06-03 97020\n2019-06-04 97380\n2019-06-05 95999\n2019-06-06 97205"
  },
  {
    "objectID": "aula_2.html#agora-vamos-converter-os-pre√ßos-di√°rios-em-mensais",
    "href": "aula_2.html#agora-vamos-converter-os-pre√ßos-di√°rios-em-mensais",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Agora vamos converter os pre√ßos di√°rios em mensais",
    "text": "Agora vamos converter os pre√ßos di√°rios em mensais\n\nprices_monthly &lt;- to.monthly(prices, indexAt = \"lastof\", OHLC = FALSE)\nhead(prices_monthly)\n\n           VALE3.SA  PETR4.SA AZUL4.SA  MGLU3.SA CMIG4.SA\n2019-05-31 30.86573  8.593929    39.20  56.97055 4.318573\n2019-06-30 32.64209  9.219557    43.29  61.36543 4.344906\n2019-07-31 31.37597  8.772199    51.78  76.65446 4.137171\n2019-08-31 28.70514  8.644517    47.10  84.38617 4.318573\n2019-09-30 30.07835  9.339466    49.71  86.13017 4.192761\n2019-10-31 29.73190 10.302230    52.52 104.00202 3.993803\n\nibov_monthly &lt;- to.monthly(ibov, indexAt = \"lastof\", OHLC = FALSE)\nhead(ibov_monthly)\n\n             IBOV\n2019-05-31  97030\n2019-06-30 100967\n2019-07-31 101812\n2019-08-31 101135\n2019-09-30 104745\n2019-10-31 107220"
  },
  {
    "objectID": "aula_2.html#vamos-calcular-os-retornos-mensais",
    "href": "aula_2.html#vamos-calcular-os-retornos-mensais",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Vamos calcular os retornos mensais",
    "text": "Vamos calcular os retornos mensais\n\nasset_returns_xts &lt;-\n PerformanceAnalytics::Return.calculate(prices_monthly, \n                   method = \"discrete\") %&gt;% \n  na.omit()\n\nibov_returns_xts &lt;- \n  PerformanceAnalytics::Return.calculate(ibov_monthly, \n                   method = \"discrete\") %&gt;% \n  na.omit()\n\nhead(asset_returns_xts)\n\n              VALE3.SA    PETR4.SA    AZUL4.SA    MGLU3.SA     CMIG4.SA\n2019-06-30  0.05755118  0.07279877  0.10433674 0.077142847  0.006097582\n2019-07-31 -0.03878804 -0.04852274  0.19611914 0.249147457 -0.047811281\n2019-08-31 -0.08512360 -0.01455527 -0.09038240 0.100864375  0.043847038\n2019-09-30  0.04783851  0.08039190  0.05541403 0.020666842 -0.029132781\n2019-10-31 -0.01151822  0.10308553  0.05652789 0.207498229 -0.047452887\n2019-11-30  0.05889816 -0.03443148  0.01104337 0.008736587 -0.043955955\n\nhead(ibov_returns_xts)\n\n                   IBOV\n2019-06-30  0.040575080\n2019-07-31  0.008369071\n2019-08-31 -0.006649511\n2019-09-30  0.035694863\n2019-10-31  0.023628813\n2019-11-30  0.009447864"
  },
  {
    "objectID": "aula_2.html#otimiza√ß√£o-da-carteira",
    "href": "aula_2.html#otimiza√ß√£o-da-carteira",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Otimiza√ß√£o da carteira",
    "text": "Otimiza√ß√£o da carteira\n\n#| message: false\n\n# Criando o objeto de otimiza√ß√£o\n\nportf &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\n# Adicionando restri√ß√µes, como por exemplo, a soma dos pesos dos ativos deve ser igual a 1\n\nportf &lt;- add.constraint(portf, type = \"full_investment\")\n\n# Adicionando restri√ß√£o de peso m√≠nimo e m√°ximo para cada ativo\n# Neste caso, o peso m√≠nimo √© 0 e o peso m√°ximo √© 1\n\nportf &lt;- add.constraint(portf, type = \"long_only\")\n\n\n# Adiciona a fun√ß√£o objetivo, que √© minimizar o desvio padr√£o da carteira\n\nportf &lt;- add.objective(portf, type = \"risk\", name = \"StdDev\")\n\n# Resolve o problema de otimiza√ß√£o\n\nopt_portf &lt;- optimize.portfolio(asset_returns_xts, portf, optimize_method = \"ROI\")"
  },
  {
    "objectID": "aula_2.html#resultados-da-otimiza√ß√£o",
    "href": "aula_2.html#resultados-da-otimiza√ß√£o",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Resultados da otimiza√ß√£o",
    "text": "Resultados da otimiza√ß√£o\n\nopt_portf\n\n***********************************\nPortfolioAnalytics Optimization\n***********************************\n\nCall:\noptimize.portfolio(R = asset_returns_xts, portfolio = portf, \n    optimize_method = \"ROI\")\n\nOptimal Weights:\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n  0.4881   0.0953   0.0000   0.0428   0.3738 \n\nObjective Measure:\n StdDev \n0.07238"
  },
  {
    "objectID": "aula_2.html#extraindo-os-pesos-dos-ativos",
    "href": "aula_2.html#extraindo-os-pesos-dos-ativos",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Extraindo os pesos dos ativos",
    "text": "Extraindo os pesos dos ativos\n\n# extraindo os pesos para um data frame\nweights &lt;- extractWeights(opt_portf)\n\n# Adicionando os nomes dos ativos sem coloc√°-los no √≠ndice\nweights &lt;- data.frame(tickers = colnames(asset_returns_xts), weights, row.names = NULL)\n\nweights\n\n   tickers    weights\n1 VALE3.SA 0.48813406\n2 PETR4.SA 0.09528922\n3 AZUL4.SA 0.00000000\n4 MGLU3.SA 0.04276910\n5 CMIG4.SA 0.37380762"
  },
  {
    "objectID": "aula_2.html#plotando-com-o-portfolioanalytics",
    "href": "aula_2.html#plotando-com-o-portfolioanalytics",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "plotando com o portfolioAnalytics",
    "text": "plotando com o portfolioAnalytics\n\nchart.Weights(opt_portf)"
  },
  {
    "objectID": "aula_2.html#plotando-com-ggplo2",
    "href": "aula_2.html#plotando-com-ggplo2",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Plotando com ggplo2",
    "text": "Plotando com ggplo2\n\nggplot(weights, aes(x = reorder(tickers, weights), y = weights, fill = tickers)) +\n  geom_col(color = \"black\", show.legend = FALSE) +\n  theme_minimal(base_size = 14) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1),\n    plot.title = element_text(hjust = 0.5, size = 20, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5, size = 16),\n    legend.position = \"none\") +\n  scale_fill_viridis_d() +\n  labs(title = \"Distribui√ß√£o dos Pesos dos Ativos\",\n   x = \"Ativos\",\n   y = \"Pesos\") +\n  coord_flip()"
  },
  {
    "objectID": "aula_2.html#realizando-otimiza√ß√£o-da-fun√ß√£o-de-utilidade-com-o-portfolioanalytics",
    "href": "aula_2.html#realizando-otimiza√ß√£o-da-fun√ß√£o-de-utilidade-com-o-portfolioanalytics",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Realizando otimiza√ß√£o da fun√ß√£o de utilidade com o PortfolioAnalytics",
    "text": "Realizando otimiza√ß√£o da fun√ß√£o de utilidade com o PortfolioAnalytics\n\n#criar o objeto de otimiza√ß√£o\n\nportf &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\n# Adicionando restri√ß√µes, como por exemplo, a soma dos pesos dos ativos deve ser igual a 1\n\nportf &lt;- add.constraint(portf, type = \"full_investment\")\n\n# Adicionando restri√ß√£o de peso m√≠nimo e m√°ximo para cada ativo (0-1)\n\nportf &lt;- add.constraint(portf, type = \"long_only\")\n\n# Adiciona a fun√ß√£o objetivo, que √© maximizar o retorno esperado\n\nportf &lt;- add.objective(portf, type = \"return\", name = \"mean\")\n\n# Adiciona a fun√ß√£o objetivo, que √© minimizar a vari√¢ncia da carteira\n\nportf &lt;- add.objective(portf, type = \"risk\", name = \"var\")\n\nportf &lt;- add.objective(portf, type = \"quadratic_utility\", risk_aversion = 10)\n\n# Resolve o problema de otimiza√ß√£o\n\nopt_portf &lt;- optimize.portfolio(asset_returns_xts, portf, optimize_method = \"ROI\")\n\n# Extraindo os pesos dos ativos\n\nextractWeights(opt_portf)\n\n   VALE3.SA    PETR4.SA    AZUL4.SA    MGLU3.SA    CMIG4.SA \n0.478117455 0.193940795 0.000000000 0.007504405 0.320437344"
  },
  {
    "objectID": "aula_2.html#pesos",
    "href": "aula_2.html#pesos",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Pesos",
    "text": "Pesos\n\nextractWeights(opt_portf)\n\n   VALE3.SA    PETR4.SA    AZUL4.SA    MGLU3.SA    CMIG4.SA \n0.478117455 0.193940795 0.000000000 0.007504405 0.320437344"
  },
  {
    "objectID": "aula_2.html#entendendo-a-especifica√ß√£o-do-portf√≥lio",
    "href": "aula_2.html#entendendo-a-especifica√ß√£o-do-portf√≥lio",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Entendendo a especifica√ß√£o do portf√≥lio",
    "text": "Entendendo a especifica√ß√£o do portf√≥lio\nO objeto de portf√≥lio √© uma lista que cont√©m as seguintes informa√ß√µes:\n\nassets: vetor de nomes dos ativos\nconstraints: lista de restri√ß√µes\n\nweight_sum: restri√ß√£o de que a soma dos pesos dos ativos deve ser igual a um valor espec√≠fico\nfull_investment: restri√ß√£o de que a soma dos pesos dos ativos deve ser igual a 1\ndollar_neutral: restri√ß√£o de que a soma dos pesos dos ativos deve ser igual a zero\nbox: restri√ß√£o de que os pesos dos ativos devem estar dentro de um intervalo espec√≠fico\nlong_only: restri√ß√£o de que os pesos dos ativos devem ser maiores ou iguais a zero e menores ou iguais a um (caso especial da restri√ß√£o box)\ngroup: restri√ß√£o de que os pesos dos ativos de um grupo espec√≠fico devem ser iguais\nturnover: restri√ß√£o de que o turnover da carteira deve ser menor ou igual a um valor espec√≠fico a partir de uma carteira inicial\ndiversification: Especifica um valor de diversifica√ß√£o para a carteira\nposition_limit: Permite ao usu√°rio definir o n√∫mero m√°ximo de posi√ß√µes (ativos com pesos n√£o nulos) e o n√∫mero m√°ximo de posi√ß√µes compradas e vendidas.\nreturn: Especifica o retorno m√©dio esperado da carteira\nfactor_exposure: Especifica a exposi√ß√£o da carteira a fatores de risco\nleverage_exposure: Especifica a alavancagem maxima da carteira onde a alavancagem √© definida como a soma dos pesos absolutos dos ativos\n\nobjectives:\n\ntype: ‚Äòreturn‚Äô,‚Äòrisk‚Äô, ‚Äòrisk_budget‚Äô, ‚Äòquadratic_utility‚Äô, or ‚Äôweight_concentration"
  },
  {
    "objectID": "aula_2.html#passo-a-passo-da-otimiza√ß√£o-de-portf√≥lios",
    "href": "aula_2.html#passo-a-passo-da-otimiza√ß√£o-de-portf√≥lios",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Passo a passo da otimiza√ß√£o de portf√≥lios",
    "text": "Passo a passo da otimiza√ß√£o de portf√≥lios\n\nCarregar os pre√ßos dos ativos e do benchmark\nConverter os pre√ßos di√°rios em pre√ßos mensais\nCalcular os retornos mensais dos ativos e do benchmark\nCriar o objeto de portf√≥lio\nAdicionar restri√ß√µes ao objeto de portf√≥lio\nAdicionar a fun√ß√£o objetivo ao objeto de portf√≥lio\nResolver o problema de otimiza√ß√£o\nExibir os resultados da otimiza√ß√£o\nExibir os pesos dos ativos na carteira otimizada\nPlotar a distribui√ß√£o dos pesos dos ativos na carteira otimizada"
  },
  {
    "objectID": "aula_2.html#criando-um-objeto-para-as-especifica√ß√µes-do-portf√≥lio",
    "href": "aula_2.html#criando-um-objeto-para-as-especifica√ß√µes-do-portf√≥lio",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Criando um objeto para as especifica√ß√µes do portf√≥lio",
    "text": "Criando um objeto para as especifica√ß√µes do portf√≥lio\n\n# Criando o objeto de portf√≥lio, aqui estamos apenas especificando os ativos que ser√£o utilizados na otimiza√ß√£o\n\nport_spec &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\nclass(port_spec)\n\n[1] \"portfolio.spec\" \"portfolio\""
  },
  {
    "objectID": "aula_2.html#adicionando-restri√ß√µes-ao-objeto-de-portf√≥lio",
    "href": "aula_2.html#adicionando-restri√ß√µes-ao-objeto-de-portf√≥lio",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Adicionando restri√ß√µes ao objeto de portf√≥lio",
    "text": "Adicionando restri√ß√µes ao objeto de portf√≥lio\nAs restri√ß√µes s√£o condi√ß√µes que devem ser satisfeitas durante a otimiza√ß√£o da carteira. Algumas restri√ß√µes comuns s√£o relacionadas ao peso dos ativos e ao retorno esperado da carteira.\n\n# Adicionando restri√ß√µes, como por exemplo, a soma dos pesos dos ativos deve ser igual a 1\n\nport_spec  &lt;- add.constraint(port_spec, type = \"weight_sum\", min_sum = 1, max_sum = 1)\n\n# adicionnando uma restri√ß√£o de caixas para os pesos dos ativos\n\nport_spec &lt;- add.constraint(port_spec, type = \"box\", min = c(0.2, 0.1, 0.1, 0.1, 0.1), max = 0.4)\n\n\nport_spec\n\n**************************************************\nPortfolioAnalytics Portfolio Specification \n**************************************************\n\nCall:\nportfolio.spec(assets = colnames(asset_returns_xts))\n\nNumber of assets: 5 \nAsset Names\n[1] \"VALE3.SA\" \"PETR4.SA\" \"AZUL4.SA\" \"MGLU3.SA\" \"CMIG4.SA\"\n\nConstraints\nEnabled constraint types\n        - weight_sum \n        - box"
  },
  {
    "objectID": "aula_2.html#adicionando-a-fun√ß√£o-objetivo-ao-objeto-de-portf√≥lio",
    "href": "aula_2.html#adicionando-a-fun√ß√£o-objetivo-ao-objeto-de-portf√≥lio",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Adicionando a fun√ß√£o objetivo ao objeto de portf√≥lio",
    "text": "Adicionando a fun√ß√£o objetivo ao objeto de portf√≥lio\nA fun√ß√£o objetivo √© a fun√ß√£o que ser√° otimizada durante o processo de otimiza√ß√£o da carteira. Um objetivo comum √© maximizar o retorno esperado da carteira e minimizar a volatilidade e o risco.\nLembre-se que o desvio padr√£o √© a raiz quadrada da vari√¢ncia. E que a vari√¢ncia √© a m√©dia dos quadrados dos desvios em rela√ß√£o √† m√©dia. A variancia √© geralmente usada para denotar o risco, quanto maior a variancia, maior o risco. J√° geralmente denota a volatilidade, quanto maior o desvio padr√£o, maior a volatilidade. Ambas s√£o medidas que servem como indicadores de risco.\nNo portfolioAnalytics, a fun√ß√£o objetivo √© adicionada ao objeto de portf√≥lio usando a fun√ß√£o add.objective(). Os objetivos mais usado s√£o:\n\nreturn: Maximizar o retorno esperado da carteira\nrisk: Minimizar o risco da carteira\nrisk_budget: Minimizar a contribui√ß√£o marginal do risco de cada ativo para o risco total da carteira\nquadratic_utility: Maximizar a fun√ß√£o de utilidade quadr√°tica da carteira\nweight_concentration: Minimizar a concentra√ß√£o dos pesos dos ativos na carteira\n\n\n# Adiciona a fun√ß√£o objetivo, que √© maximizar o retorno m√©dio esperado da carteira\n\nport_spec &lt;- add.objective(port_spec, type = \"return\", name = \"mean\")\n\n# Adiciona a fun√ß√£o objetivo, que √© minimizar o desvio padr√£o da carteira\n\nport_spec &lt;- add.objective(port_spec, type = \"risk\", name = \"StdDev\")\n\n# Adiciona um objetivo para minimizar a contribui√ß√£o marginal do risco de cada ativo para o risco total da carteira\n\nport_spec &lt;- add.objective(port_spec, type = \"risk_budget\", name = \"var\", min_prisk = 0.05, max_prisk = 0.1)\n\nprint(port_spec)\n\n**************************************************\nPortfolioAnalytics Portfolio Specification \n**************************************************\n\nCall:\nportfolio.spec(assets = colnames(asset_returns_xts))\n\nNumber of assets: 5 \nAsset Names\n[1] \"VALE3.SA\" \"PETR4.SA\" \"AZUL4.SA\" \"MGLU3.SA\" \"CMIG4.SA\"\n\nConstraints\nEnabled constraint types\n        - weight_sum \n        - box \n\nObjectives:\nEnabled objective names\n        - mean \n        - StdDev \n        - var"
  },
  {
    "objectID": "aula_2.html#resolvendo-o-problema-de-otimiza√ß√£o",
    "href": "aula_2.html#resolvendo-o-problema-de-otimiza√ß√£o",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Resolvendo o problema de otimiza√ß√£o",
    "text": "Resolvendo o problema de otimiza√ß√£o\nExistem duas fun√ß√µes principais para resolver o problema de otimiza√ß√£o da carteira: optimize.portfolio() e optimize.portfolio.rebalancing(). A fun√ß√£o optimize.portfolio() √© usada para otimizar a carteira sem rebalanceamento, enquanto a fun√ß√£o optimize.portfolio.rebalancing() √© usada para otimizar a carteira com rebalanceamento.\nLembre-se que o rebalanceamento √© o processo de ajustar os pesos dos ativos na carteira para manter a aloca√ß√£o desejada ao longo do tempo.\nO pacote suporta diversos m√©todos de otimiza√ß√£o, como:\n\nDEoptim: Differential Evolution\nrandom: Random Portfolios\nGenSA: Generalized Simulated Annealing\npso: Particle Swarm Optimization\nROI: R Optimization Infrastructure\n\nO m√©todo a ser usado ir√° depender do problema.\nVamos fazer fazer uma otimiza√ß√£o usando o m√©todo de portifolios aleat√≥rios. Nosso objetivo √© maximizar o retorno esperado da carteira e minimizar o risco onde o risco minimo √© 5% e o risco maximo √© 10% sujeito a restri√ß√µes de peso e de grupo.\n\n# .storage &lt;&lt;- new.env()\n\nrp &lt;- random_portfolios(port_spec, permutations = 1000, rp_method = 'simplex')\n\nWarning: executing %dopar% sequentially: no parallel backend registered\n\n# rp &lt;- random_portfolios(port_spec, permutations = 1000, rp_method = 'sample')\n# rp &lt;- random_portfolios(port_spec, permutations = 1000, rp_method = 'grid') \n\nhead(rp)\n\n      VALE3.SA  PETR4.SA  AZUL4.SA  MGLU3.SA  CMIG4.SA\n[1,] 0.2129896 0.1767381 0.3996827 0.1083525 0.1022372\n[2,] 0.2091820 0.1943104 0.1462174 0.1970533 0.2532369\n[3,] 0.2067608 0.1879881 0.1157554 0.1943518 0.2951439\n[4,] 0.2632710 0.1832084 0.2626849 0.1410737 0.1497619\n[5,] 0.2044441 0.2579728 0.1180301 0.3187101 0.1008430\n[6,] 0.2710928 0.1518522 0.3300403 0.1155672 0.1314476\n\n\nSimplex: Distribui pesos aleatoriamente em um espa√ßo triangular, garantindo que a soma seja sempre 1. Sample: Seleciona pesos aleat√≥rios de uma distribui√ß√£o de probabilidade espec√≠fica. Grid: Gera pesos em pontos pr√©-definidos de uma grade regular.\n\nopt  &lt;-  optimize.portfolio(R = asset_returns_xts, port_spec, rp = rp, optimize_method = \"random\", trace = TRUE)\n\nLeverage constraint min_sum and max_sum are restrictive, \n              consider relaxing. e.g. 'full_investment' constraint should be min_sum=0.99 and max_sum=1.01\n\nprint(opt)\n\n***********************************\nPortfolioAnalytics Optimization\n***********************************\n\nCall:\noptimize.portfolio(R = asset_returns_xts, portfolio = port_spec, \n    optimize_method = \"random\", trace = TRUE, rp = rp)\n\nOptimal Weights:\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n  0.3433   0.1313   0.1042   0.1000   0.3213 \n\nObjective Measures:\n   mean \n0.01483 \n\n\n StdDev \n0.08163 \n\ncontribution :\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n 0.01902  0.01069  0.01707  0.01174  0.02311 \n\npct_contrib_StdDev :\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n  0.2330   0.1309   0.2091   0.1439   0.2831"
  },
  {
    "objectID": "aula_2.html#otimizando-a-carteira-com-rebalanceamento",
    "href": "aula_2.html#otimizando-a-carteira-com-rebalanceamento",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Otimizando a carteira com rebalanceamento",
    "text": "Otimizando a carteira com rebalanceamento\nA fun√ß√£o optimize.portfolio.rebalancing() √© usada para otimizar a carteira com rebalanceamento. O rebalanceamento √© o processo de ajustar os pesos dos ativos na carteira para manter a aloca√ß√£o desejada ao longo do tempo. O rebalanceamento √© importante para garantir que a carteira permane√ßa alinhada com os objetivos de investimento (restri√ß√µes e objetivos) ao longo do tempo.\noptimize.portfolio.rebalancing() suporta otimiza√ß√£o de carteiras com rebalanceamento em diferentes janelas de tempo. O backtest √© o processo de testar uma estrat√©gia de investimento em dados hist√≥ricos para avaliar seu desempenho.\nOBS: Dependendo do m√©todo de otimiza√ß√£o, o processo pode ser demorado.\nExemplo de otimiza√ß√£o com rebalanceamento:\n\n# Criar o objeto de portf√≥lio\nport_specr &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\n# Adicionar restri√ß√µes - full investment com soma de pesos igual a 1\n\nport_specr &lt;- add.constraint(port_specr, type = \"long_only\")\n\n# restri√ß√£o para a soma dos pesos\n\nport_specr &lt;- add.constraint(port_specr, type = \"weight_sum\", min_sum = 0.99, max_sum = 1.01)\n\n# Adicionar a fun√ß√£o objetivo - maximizar o retorno esperado\n\nport_specr &lt;- add.objective(port_specr, type = \"return\", name = \"mean\")\n\n# Adicionar a fun√ß√£o objetivo - minimizar o risco\n\nport_specr &lt;- add.objective(port_specr, type = \"risk\", name = \"StdDev\")\n\n# Adicionar a fun√ß√£o objetivo - minimizar a contribui√ß√£o marginal do risco de cada ativo para o risco total da carteira\n\nport_specr &lt;- add.objective(port_specr, type = \"risk_budget\", name = \"StdDev\", min_prisk = 0.05, max_prisk = 0.1)\n\nrp &lt;- random_portfolios(port_specr, permutations = 50, rp_method = 'simplex')"
  },
  {
    "objectID": "aula_2.html#otimiza√ß√£o",
    "href": "aula_2.html#otimiza√ß√£o",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Otimiza√ß√£o",
    "text": "Otimiza√ß√£o\n\n# Otimiza√ß√£o com rebalanceamento mensal\n\nopt_rebal &lt;- optimize.portfolio.rebalancing(R = asset_returns_xts, \n                      portfolio = port_specr, \n                      optimize_method = \"random\",\n                      rp = rp,\n                      trace = TRUE,\n                      search_size = 1000,\n                      rebalance_on = \"months\",\n                      training_period = 12,\n                      rolling_window = 12)\n\nprint(opt_rebal)\n\n**************************************************\nPortfolioAnalytics Optimization with Rebalancing\n**************************************************\n\nCall:\noptimize.portfolio.rebalancing(R = asset_returns_xts, portfolio = port_specr, \n    optimize_method = \"random\", search_size = 1000, trace = TRUE, \n    rp = rp, rebalance_on = \"months\", training_period = 12, rolling_window = 12)\n\nNumber of rebalancing dates:  49 \nFirst rebalance date:\n[1] \"2020-05-31\"\nLast rebalance date:\n[1] \"2024-05-31\"\n\nAnnualized Portfolio Rebalancing Return:\n[1] 0.07826747\n\nAnnualized Portfolio Standard Deviation:\n[1] 0.3166047"
  },
  {
    "objectID": "aula_2.html#analise-dos-resultados",
    "href": "aula_2.html#analise-dos-resultados",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Analise dos resultados",
    "text": "Analise dos resultados\n\nextractObjectiveMeasures(opt_rebal) |&gt; head(1)\n\n                  mean    StdDev StdDev.contribution.VALE3.SA\n2020-05-31 0.007778412 0.1146587                  0.009231419\n           StdDev.contribution.PETR4.SA StdDev.contribution.AZUL4.SA\n2020-05-31                   0.01697412                   0.01598271\n           StdDev.contribution.MGLU3.SA StdDev.contribution.CMIG4.SA\n2020-05-31                   0.02321859                   0.04925188\n           StdDev.pct_contrib_StdDev.VALE3.SA\n2020-05-31                         0.08051214\n           StdDev.pct_contrib_StdDev.PETR4.SA\n2020-05-31                          0.1480404\n           StdDev.pct_contrib_StdDev.AZUL4.SA\n2020-05-31                          0.1393937\n           StdDev.pct_contrib_StdDev.MGLU3.SA\n2020-05-31                          0.2025017\n           StdDev.pct_contrib_StdDev.CMIG4.SA\n2020-05-31                           0.429552\n\nextractWeights(opt_rebal) |&gt; head()\n\n            VALE3.SA  PETR4.SA   AZUL4.SA  MGLU3.SA  CMIG4.SA\n2020-05-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-06-30 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-07-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-08-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-09-30 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-10-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n\nchart.Weights(opt) \n\n\n\n\n\n\n\nchart.Weights(opt_rebal)"
  },
  {
    "objectID": "aula_2.html#plotando-os-pesos-ao-longo-do-tempo-com-ggplot2",
    "href": "aula_2.html#plotando-os-pesos-ao-longo-do-tempo-com-ggplot2",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Plotando os pesos ao longo do tempo com ggplot2",
    "text": "Plotando os pesos ao longo do tempo com ggplot2\n\n# Extraindo os pesos dos ativos ao longo do tempo\n\nweights_xts &lt;- extractWeights(opt_rebal)\n\n# Convertendo os pesos para um data frame\n\nweights_df &lt;- weights_xts %&gt;% \n              tk_tbl(preserve_index = TRUE, rename_index = \"Date\")\n\n\n# Colocando o data frame em formato longo\n\nweights_long_df &lt;- weights_df %&gt;% \n                pivot_longer(cols = -Date, names_to = \"Asset\", values_to = \"Weight\")\n\n\nplotly::ggplotly(ggplot(weights_long_df) +\n  aes(x = Date, y = Weight, colour = Asset) +\n  geom_smooth(se = FALSE ) +\n  scale_fill_hue(direction = 1) +\n  labs(\n    x = \"Data\",\n    y = \"Peso\",\n    title = \"Peso dos ativos rebalanceados ao longo do tempo\",\n    colour = \"Ativos\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 16L,\n    face = \"bold\",\n    hjust = 0.5)\n  )\n)\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'"
  },
  {
    "objectID": "aula_2.html#plotando-o-retorno-do-portf√≥lio-ao-longo-do-tempo",
    "href": "aula_2.html#plotando-o-retorno-do-portf√≥lio-ao-longo-do-tempo",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Plotando o retorno do portf√≥lio ao longo do tempo",
    "text": "Plotando o retorno do portf√≥lio ao longo do tempo\n\n# Calculando o retorno do portf√≥lio otimizado e adicionando o retorno do IBOV\nopt_returns_long_df &lt;- Return.portfolio(R = asset_returns_xts, weights = extractWeights(opt_rebal)) %&gt;%\n  tk_tbl(preserve_index = TRUE, rename_index = \"Date\") %&gt;%\n  inner_join(ibov_returns_xts %&gt;% tk_tbl(preserve_index = TRUE, rename_index = \"Date\"), by = \"Date\", suffix = c(\"_Portfolio\", \"_IBOV\")) %&gt;%\n  pivot_longer(cols = -Date, names_to = \"Portfolio\", values_to = \"Return\")\n\nplotly::ggplotly(ggplot(opt_returns_long_df) +\n  aes(x = Date, y = Return, colour = Portfolio) +\n  geom_line() +\n  scale_fill_hue(direction = 1) +\n  labs(\n    x = \"Data\",\n    y = \"Retorno\",\n    title = \"Retorno do portif√≥lio vs IBOV ao longo do tempo\",\n    colour = \"Portf√≥lio\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 16L,\n    face = \"bold\",\n    hjust = 0.5)\n  )\n)"
  },
  {
    "objectID": "aula_2.html#bonus-plotando-a-fronteira-eficiente",
    "href": "aula_2.html#bonus-plotando-a-fronteira-eficiente",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Bonus: Plotando a fronteira eficiente",
    "text": "Bonus: Plotando a fronteira eficiente\nA fronteira eficiente √© uma curva que mostra a combina√ß√£o √≥tima de ativos em uma carteira que maximiza o retorno esperado para um determinado n√≠vel de risco. Note que o indice de Sharpe √© a inclina√ß√£o da linha tangente a fronteira eficiente, o intercepto com o eixo y √© o retorno livre de risco e o ponto de tang√™ncia √© o ponto com o maior indice de Sharpe.\n\n# Calculando a fronteira eficiente\nfrontier &lt;- create.EfficientFrontier(R = asset_returns_xts, portfolio = port_spec, type = \"mean-StdDev\")\n\n# Plotando a fronteira eficiente\nchart.EfficientFrontier(frontier, match.col = \"StdDev\",n.portfolios = 30, main = \"Fronteira eficiente\")"
  },
  {
    "objectID": "aula_2.html#dashboards-interativos-com-quarto",
    "href": "aula_2.html#dashboards-interativos-com-quarto",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Dashboards interativos com QUARTO",
    "text": "Dashboards interativos com QUARTO\nClique aqui!!"
  },
  {
    "objectID": "aula_2.html#exerc√≠cio",
    "href": "aula_2.html#exerc√≠cio",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Exerc√≠cio",
    "text": "Exerc√≠cio\n\nCrie uma carteira com 5 ativos de sua escolha\nBaixe os pre√ßos dos ativos\nCalcule os retornos mensais\nCrie um vetor de pesos para a carteira\nCalcule o retorno da carteira\nFa√ßa a otimiza√ß√£o da carteira com o objetivo de maximizar o retorno esperado e minimizar o risco\nOpcionalmente fa√ßa a otimiza√ß√£o com rebalanceamento\nVisualize o retorno da carteira e dos ativos\nCompare o retorno da carteira com o √≠ndice do mercado\nSalve o seu dashboard e compartilhe com o professor"
  },
  {
    "objectID": "aula_2.html#dica-use-o-arquivo-das-aulas-anteriores-como-refer√™ncia-para-criar-o-seu-dashboard",
    "href": "aula_2.html#dica-use-o-arquivo-das-aulas-anteriores-como-refer√™ncia-para-criar-o-seu-dashboard",
    "title": "Aula 2 - An√°lise e otimiza√ß√£o de carteiras",
    "section": "Dica: Use o arquivo das aulas anteriores como refer√™ncia para criar o seu dashboard",
    "text": "Dica: Use o arquivo das aulas anteriores como refer√™ncia para criar o seu dashboard"
  },
  {
    "objectID": "aula_1.html",
    "href": "aula_1.html",
    "title": "Aula 1",
    "section": "",
    "text": "Criar um novo projeto no RStudio cloud (ou posit cloud)\nCriar um documento QUARTO\nCriar um portif√≥lio com 5 ativos ou mais (consultar no yahoo finance)\nBaixar os dados de pre√ßo\nVisualizar o gr√°fico de pre√ßos mensais dos ativos\nCalcular e visualizar os retornos mensais\nExplorar outras fun√ß√µes (se der tempo)"
  },
  {
    "objectID": "aula_1.html#trabalhando-com-um-portif√≥lio-ou-carteira",
    "href": "aula_1.html#trabalhando-com-um-portif√≥lio-ou-carteira",
    "title": "Aula 1",
    "section": "",
    "text": "Criar um novo projeto no RStudio cloud (ou posit cloud)\nCriar um documento QUARTO\nCriar um portif√≥lio com 5 ativos ou mais (consultar no yahoo finance)\nBaixar os dados de pre√ßo\nVisualizar o gr√°fico de pre√ßos mensais dos ativos\nCalcular e visualizar os retornos mensais\nExplorar outras fun√ß√µes (se der tempo)"
  },
  {
    "objectID": "aula_1.html#antes-de-mais-nada-vamos-carregar-os-pacotes-que-ser√£o-usados",
    "href": "aula_1.html#antes-de-mais-nada-vamos-carregar-os-pacotes-que-ser√£o-usados",
    "title": "Aula 1",
    "section": "Antes de mais nada, vamos carregar os pacotes que ser√£o usados",
    "text": "Antes de mais nada, vamos carregar os pacotes que ser√£o usados\n\nlibrary(tidyverse)\nlibrary(quantmod)\nlibrary(PerformanceAnalytics)\nlibrary(timetk)#pregui√ßa"
  },
  {
    "objectID": "aula_1.html#vamos-criar-nossa-carteira",
    "href": "aula_1.html#vamos-criar-nossa-carteira",
    "title": "Aula 1",
    "section": "Vamos criar nossa carteira",
    "text": "Vamos criar nossa carteira\nv√° ate o site yahoo finance( https://finance.yahoo.com/) e selecione 5 ativos de sua preferencia.\n\nPesquise cada uma dessas empresas no site\ncopie o simbolo(ticker) de cada uma e crie um vetor num chunk do seu documento.\n\n\n\n\n\n\n\nTip\n\n\n\nLembre-se, voc√™ pode adicionar um novo trecho de c√≥digo com o atalho!\n\n\nEu vou escolher as seguintes empresas:\nVale, Petrobras, Azul e Magazine Luiza\n\ntickers &lt;- c(\"VALE3.SA\",\"PETR4.SA\",\"AZUL4.SA\",\"MGLU3.SA\",\"^BVSP\")"
  },
  {
    "objectID": "aula_1.html#vamos-baixar-os-pre√ßos-dentro-de-um-periodo-usando-o-pacote-quantmod",
    "href": "aula_1.html#vamos-baixar-os-pre√ßos-dentro-de-um-periodo-usando-o-pacote-quantmod",
    "title": "Aula 1",
    "section": "Vamos baixar os pre√ßos dentro de um periodo usando o pacote quantmod",
    "text": "Vamos baixar os pre√ßos dentro de um periodo usando o pacote quantmod\n\nprices &lt;- \n  getSymbols(tickers, \n             src = 'yahoo', \n             from = \"2020-01-01\",\n             to = \"2023-05-30\",\n             auto.assign = TRUE, #obs auto asign carrega os resultados para o ambiente\n             warnings = FALSE,) %&gt;% \n  map(~Ad(get(.))) %&gt;% \n  reduce(merge) %&gt;%\n  `colnames&lt;-`(tickers)\n\nhead(prices)\n\n           VALE3.SA PETR4.SA AZUL4.SA MGLU3.SA  ^BVSP\n2020-01-02 35.13004 10.62144    58.80 115.0151 118573\n2020-01-03 34.87139 10.53494    56.76 113.9892 117707\n2020-01-06 34.66448 10.65950    55.00 114.0824 116878\n2020-01-07 34.91665 10.61798    56.82 113.7560 116662\n2020-01-08 34.92312 10.55224    56.92 117.2533 116247\n2020-01-09 34.46403 10.51765    57.28 121.4268 115947\n\nclass(prices)\n\n[1] \"xts\" \"zoo\""
  },
  {
    "objectID": "aula_1.html#agora-vamos-converter-os-pre√ßos-di√°rios-em-mensais",
    "href": "aula_1.html#agora-vamos-converter-os-pre√ßos-di√°rios-em-mensais",
    "title": "Aula 1",
    "section": "Agora vamos converter os pre√ßos di√°rios em mensais",
    "text": "Agora vamos converter os pre√ßos di√°rios em mensais\n\nprices_monthly &lt;- to.monthly(prices, indexAt = \"lastof\", OHLC = FALSE)\nhead(prices_monthly)\n\n           VALE3.SA PETR4.SA AZUL4.SA  MGLU3.SA  ^BVSP\n2020-01-31 32.50481 9.842996    59.26 130.10014 113761\n2020-02-29 28.65105 8.767012    44.44 117.78960 104172\n2020-03-31 27.94625 4.840193    17.55  90.90689  73020\n2020-04-30 29.00669 6.244852    17.40 115.87772  80506\n2020-05-31 34.27005 7.037136    14.28 150.03484  87403\n2020-06-30 36.15813 7.455764    20.11 167.05510  95056"
  },
  {
    "objectID": "aula_1.html#podemos-agora-calcular-os-retornos",
    "href": "aula_1.html#podemos-agora-calcular-os-retornos",
    "title": "Aula 1",
    "section": "Podemos agora calcular os retornos",
    "text": "Podemos agora calcular os retornos\nPodemos calcular o retorno linear: \\[ Retorno\\,linear = \\frac{Pre√ßo_{final}-Pre√ßo_{inicial}}{Pre√ßo_{inicial}}\\]\nOu Logar√≠tmico: \\[ Log\\,Retorno = \\ln(\\frac{Pre√ßo_{final}}{Pre√ßo_{inicial}})\\]\nNormalmente o retorno logar√≠tmico √© usado em series temporais mais longas, enquanto o retorno linear √© mais usado para calcular a varia√ß√£o dos pre√ßos em per√≠odos menores. Vamos usar o retorno linear no nosso estudo.\n\nasset_returns_xts &lt;-\n PerformanceAnalytics::Return.calculate(prices_monthly, \n                   method = \"discrete\") %&gt;% \n  na.omit()\nhead(asset_returns_xts)\n\n              VALE3.SA    PETR4.SA     AZUL4.SA    MGLU3.SA       ^BVSP\n2020-02-29 -0.11855972 -0.10931469 -0.250084376 -0.09462362 -0.08429075\n2020-03-31 -0.02459950 -0.44790842 -0.605085514 -0.22822649 -0.29904389\n2020-04-30  0.03794563  0.29020717 -0.008546987  0.27468581  0.10251986\n2020-05-31  0.18145335  0.12686986 -0.179310342  0.29476858  0.08567063\n2020-06-30  0.05509419  0.05948844  0.408263374  0.11344208  0.08755992\n2020-07-31  0.08565810  0.03018342  0.009945244  0.12772308  0.08264602\n\nsummary(asset_returns_xts)\n\n     Index               VALE3.SA           PETR4.SA           AZUL4.SA        \n Min.   :2020-02-29   Min.   :-0.14715   Min.   :-0.44791   Min.   :-0.605086  \n 1st Qu.:2020-12-23   1st Qu.:-0.06259   1st Qu.:-0.04695   1st Qu.:-0.104400  \n Median :2021-10-15   Median : 0.02811   Median : 0.02163   Median :-0.032531  \n Mean   :2021-10-15   Mean   : 0.01973   Mean   : 0.02799   Mean   : 0.001149  \n 3rd Qu.:2022-08-07   3rd Qu.: 0.07765   3rd Qu.: 0.11125   3rd Qu.: 0.080608  \n Max.   :2023-05-31   Max.   : 0.28819   Max.   : 0.31468   Max.   : 0.687237  \n    MGLU3.SA            ^BVSP          \n Min.   :-0.37097   Min.   :-0.299044  \n 1st Qu.:-0.16961   1st Qu.:-0.035680  \n Median :-0.02788   Median : 0.005701  \n Mean   :-0.01113   Mean   : 0.002558  \n 3rd Qu.: 0.10304   3rd Qu.: 0.060130  \n Max.   : 0.65504   Max.   : 0.158975"
  },
  {
    "objectID": "aula_1.html#ahhh-mas-eu-nao-sei-usar-o-ggplot-√©-muito-dificil",
    "href": "aula_1.html#ahhh-mas-eu-nao-sei-usar-o-ggplot-√©-muito-dificil",
    "title": "Aula 1",
    "section": "Ahhh mas eu nao sei usar o ggplot, √© muito dificil ü•≤",
    "text": "Ahhh mas eu nao sei usar o ggplot, √© muito dificil ü•≤"
  },
  {
    "objectID": "aula_1.html#seus-problemas-acabaram",
    "href": "aula_1.html#seus-problemas-acabaram",
    "title": "Aula 1",
    "section": "SEUS PROBLEMAS ACABARAM!",
    "text": "SEUS PROBLEMAS ACABARAM!"
  },
  {
    "objectID": "aula_1.html#com-esquisse-voc√™-plota-gr√°ficos-com-o-ggplot2-sem-saber-nada-de-ggplot2",
    "href": "aula_1.html#com-esquisse-voc√™-plota-gr√°ficos-com-o-ggplot2-sem-saber-nada-de-ggplot2",
    "title": "Aula 1",
    "section": "Com esquisse voc√™ plota gr√°ficos com o ggplot2 sem saber nada de ggplot2 üòÅ",
    "text": "Com esquisse voc√™ plota gr√°ficos com o ggplot2 sem saber nada de ggplot2 üòÅ\nTente rodar o codigo a seguir\n\nesquisse::esquisser(asset_returns_tbl)\n\nVamos testar ao vivo! Voltamos em Breve‚Ä¶"
  },
  {
    "objectID": "aula_1.html#voltando-vamos-dar-peso-√†s-nossas-escolhas",
    "href": "aula_1.html#voltando-vamos-dar-peso-√†s-nossas-escolhas",
    "title": "Aula 1",
    "section": "Voltando‚Ä¶ vamos dar peso √†s nossas escolhas",
    "text": "Voltando‚Ä¶ vamos dar peso √†s nossas escolhas\nVamos criar um vetor de pesos para os nossos ativos, ele vai ser importante quando formos calcular os retornos da nossa carteira. Vamos chamar esse vetor de w.\n\nw &lt;- c(0.25,0.25,0.20,0.20,0.10)\n\nsum(w)\n\n[1] 1\n\n\n\n\n\n\n\n\nAten√ß√£o!!\n\n\n\nA soma dos pesos da carteira dever√° ser sempre igual a 100%, ou seja 1.\n\n\nO caÃÅlculo do retorno de uma carteira depende do retorno de cada ativo e de seu peso na carteira e pode ser obtido pela meÃÅdia ponderada:\n\\[ \\bar{k}=\\sum_{i=i}^n{w_i*k_i}\\]"
  },
  {
    "objectID": "aula_1.html#vamos-usar-o-performanceanlytics-para-obter-o-retorno-do-portif√≥lio-e-visualizar-rapidamente-com-a-fun√ß√£o-plot-nativa-do-r",
    "href": "aula_1.html#vamos-usar-o-performanceanlytics-para-obter-o-retorno-do-portif√≥lio-e-visualizar-rapidamente-com-a-fun√ß√£o-plot-nativa-do-r",
    "title": "Aula 1",
    "section": "Vamos usar o PerformanceAnlytics para obter o retorno do portif√≥lio e visualizar rapidamente com a fun√ß√£o plot, nativa do R",
    "text": "Vamos usar o PerformanceAnlytics para obter o retorno do portif√≥lio e visualizar rapidamente com a fun√ß√£o plot, nativa do R\n\nportfolio_returns_xts&lt;-Return.portfolio(asset_returns_xts,\n                 weights = w,\n                 rebalance_on = \"months\",\n                 type= \"discrete\") %&gt;% \n  `colnames&lt;-`(\"CARTEIRA\")\nhead(portfolio_returns_xts,3)\n\n             CARTEIRA\n2020-02-29 -0.1343393\n2020-03-31 -0.3146938\n2020-04-30  0.1455180\n\nplot(portfolio_returns_xts)"
  },
  {
    "objectID": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-ativos",
    "href": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-ativos",
    "title": "Aula 1",
    "section": "Agora vamos visualizar nossa carteira VS Ativos",
    "text": "Agora vamos visualizar nossa carteira VS Ativos\nPara isso vamos precisar criar m novo data frame com as duas vari√°veis.\n\ncompara√ß√£o &lt;- cbind(asset_returns_xts,portfolio_returns_xts) %&gt;% \n  tk_tbl(rename_index = \"Data\") %&gt;% \n  pivot_longer(!\"Data\" ,names_to = \"assets\")\n\nplotly::ggplotly(ggplot(compara√ß√£o) +\n  aes(x = Data, y = value, colour = assets) +\n  geom_line() +\n  scale_color_hue(direction = 1) +\n  labs(title = \"Retornos de 2020 a 2023 + Retorno da carteira\")+ \n  theme_minimal())"
  },
  {
    "objectID": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-√≠ndice-do-mercado",
    "href": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-√≠ndice-do-mercado",
    "title": "Aula 1",
    "section": "Agora vamos visualizar nossa carteira VS √çndice do mercado",
    "text": "Agora vamos visualizar nossa carteira VS √çndice do mercado\n\nplotly::ggplotly(compara√ß√£o %&gt;%\n filter(assets %in% c(\"X.BVSP\", \"CARTEIRA\")) %&gt;%\n ggplot() +\n  aes(x = Data, y = value, colour = assets) +\n  geom_line() +\n  scale_color_hue(direction = 1) +\n  labs(title = \"Carteira VS √çndice do mercado - 2020 - 2023\")+\n  theme_minimal())"
  }
]