[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Sejam bem vindos à disciplina de Finanças com R - análise e otimização de carteiras. Neste curso, vamos aprender a utilizar a linguagem de programação R para análise de dados financeiros e otimização de carteiras de investimento. Se este é o seu primeiro contato com a linguagem R, não se preocupe! Vamos começar do zero e aprender juntos, na prática.\n\n\n\n\n\n\nVocê não precisará instalar nada no seu computador, mas caso queira, um guia do passo a passo para tal será disponibilizado oportunamente.\n\n\n\n\n\n\nO curso é dividido em duas aulas:\n\nAula 1:\n\nApresentação do curso\nIntrodução ao RStudio\nIntrodução à programação no R\n\nObjetos, tipos de variáveis e operações\n\nFinanças com R\n\nObtenção de dados financeiros\nManipulação e visualização de dados\n\n\nAula 2:\n\nRevisão da aula anterior\nRisco\nOtimização de carteiras\nDashboards com Quarto"
  },
  {
    "objectID": "index.html#bem-vindos",
    "href": "index.html#bem-vindos",
    "title": "",
    "section": "",
    "text": "Sejam bem vindos à disciplina de Finanças com R - análise e otimização de carteiras. Neste curso, vamos aprender a utilizar a linguagem de programação R para análise de dados financeiros e otimização de carteiras de investimento. Se este é o seu primeiro contato com a linguagem R, não se preocupe! Vamos começar do zero e aprender juntos, na prática.\n\n\n\n\n\n\nVocê não precisará instalar nada no seu computador, mas caso queira, um guia do passo a passo para tal será disponibilizado oportunamente.\n\n\n\n\n\n\nO curso é dividido em duas aulas:\n\nAula 1:\n\nApresentação do curso\nIntrodução ao RStudio\nIntrodução à programação no R\n\nObjetos, tipos de variáveis e operações\n\nFinanças com R\n\nObtenção de dados financeiros\nManipulação e visualização de dados\n\n\nAula 2:\n\nRevisão da aula anterior\nRisco\nOtimização de carteiras\nDashboards com Quarto"
  },
  {
    "objectID": "index.html#referências",
    "href": "index.html#referências",
    "title": "",
    "section": "Referências",
    "text": "Referências\n\nhttps://posit.cloud/: Plataforma em nuvem para desenvolvimento colaborativo de projetos em R e Python.\nhttps://uff-adm.notion.site/Instala-o-b5969aeda52045289c52db8fd833c6b3: Guia de instalação do R e RStudio.\nhttps://ser.uff.br/: Seminário internacional de estatística com R.\nhttps://latin-r.com/pt/: Site da conferência LatinR, um evento sobre o uso da linguagem R na América Latina.\nhttps://r4ds.had.co.nz/index.html: Livro online “R for Data Science”, um guia completo para aprender a usar o R para análise de dados.\nhttps://cienciadedatos.github.io/pt-r4ds/: Tradução para o português do livro “R for Data Science” feita pela comunidade Brasileira de R.\nhttps://cran.r-project.org/: Repositório oficial de pacotes da linguagem R.\nhttps://marcusramalho.tech/RinVSCode/: Tutorial do professor Marcus Ramalho sobre como usar o R no Visual Studio Code.\nhttps://github.com/nextmarte: Perfil do GitHub do professor Marcus Ramalho.\nhttps://posit.co/download/rstudio-desktop/: Página para download do RStudio Desktop, um ambiente de desenvolvimento integrado para a linguagem R.\nhttps://quarto.org/: Site do Quarto, uma ferramenta de código aberto para criação de documentos científicos e técnicos.\nhttps://rpubs.com/Sergio_Garcia/intermediate_portfolio_analysis_r - Intermediate to Portfolio Analysis in R"
  },
  {
    "objectID": "aula_2.html",
    "href": "aula_2.html",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "",
    "text": "Risco: Probabilidade de um resultado adverso em relação ao esperado."
  },
  {
    "objectID": "aula_2.html#relembrando-alguns-conceitos-sobre-risco",
    "href": "aula_2.html#relembrando-alguns-conceitos-sobre-risco",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "",
    "text": "Risco: Probabilidade de um resultado adverso em relação ao esperado."
  },
  {
    "objectID": "aula_2.html#tipos-de-risco",
    "href": "aula_2.html#tipos-de-risco",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Tipos de risco",
    "text": "Tipos de risco\n\nRisco conhecido: Distribuição de probabilidade do evento é conhecida (ex: falha de motor).\nIncerteza: Distribuição de probabilidade desconhecida ou imprevisível (ex: crise econômica)."
  },
  {
    "objectID": "aula_2.html#atitudes-frente-ao-risco",
    "href": "aula_2.html#atitudes-frente-ao-risco",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Atitudes frente ao risco",
    "text": "Atitudes frente ao risco\n\nAversão: Prefere menor risco para mesmo retorno.\nIndiferença: Não se importa com o risco.\nPropensão: Aceita maior risco por potencial de maior retorno.\n\n\nO participante de uma apólice de seguros têm que predisposição frente ao risco?\nE a companhia de seguros?"
  },
  {
    "objectID": "aula_2.html#mensuração-do-risco",
    "href": "aula_2.html#mensuração-do-risco",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Mensuração do Risco",
    "text": "Mensuração do Risco\n\nDesvio padrão (σ): Mede a dispersão dos resultados em torno da média.\nCoeficiente de variação (CV): Mede o risco por unidade de retorno (σ / retorno médio)."
  },
  {
    "objectID": "aula_2.html#risco-de-carteira",
    "href": "aula_2.html#risco-de-carteira",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Risco de Carteira",
    "text": "Risco de Carteira\n\nCovariância: Mede a relação entre os retornos de dois ativos.\nDiversificação: Reduz o risco total da carteira ao combinar ativos com diferentes riscos (Markowitz, 1952) - “Não colocar todos os ovos na mesma cesta”."
  },
  {
    "objectID": "aula_2.html#risco-individual-vs.-sistêmico",
    "href": "aula_2.html#risco-individual-vs.-sistêmico",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Risco individual vs. sistêmico",
    "text": "Risco individual vs. sistêmico\n\nIndividual: Específico de cada ativo.\nSistêmico: Afeta todo o mercado."
  },
  {
    "objectID": "aula_2.html#índice-sharpe-is",
    "href": "aula_2.html#índice-sharpe-is",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Índice Sharpe (IS)",
    "text": "Índice Sharpe (IS)\n\nDefinição: Mede o retorno adicional por unidade de risco em relação à taxa livre de risco.\nFórmula: IS = (Retorno médio do portfólio - Taxa livre de risco) / Desvio padrão do excesso de retorno.\ninterpretação: IS &gt; 1: Retorno adicional por unidade de risco; IS &lt; 1: Retorno insuficiente por unidade de risco. Quantos mais alto o índice, melhor."
  },
  {
    "objectID": "aula_2.html#beta-β",
    "href": "aula_2.html#beta-β",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Beta (β)",
    "text": "Beta (β)\n\nDefinição: Mede a sensibilidade do retorno de um ativo em relação ao retorno do mercado.\nFórmula: β = Cov(Ri, Rm) / Var(Rm).\nInterpretação: β &gt; 1: Ativo mais volátil que o mercado; β &lt; 1: Ativo menos volátil que o mercado.\nExemplo: Se β = 1, o ativo se move na mesma direção que o mercado."
  },
  {
    "objectID": "aula_2.html#alfa-α",
    "href": "aula_2.html#alfa-α",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Alfa (α)",
    "text": "Alfa (α)\n\nDefinição: Mede o retorno adicional de um ativo em relação ao retorno esperado com base no risco.\nFórmula: α = Retorno do ativo - (Taxa livre de risco + β * (Retorno do mercado - Taxa livre de risco)).\nInterpretação: α &gt; 0: Ativo superou o retorno esperado; α &lt; 0: Ativo ficou aquém do retorno esperado.\nExemplo: Se α = 0, o ativo teve o retorno esperado com base no risco.\nObservação: O alfa é uma medida de desempenho ajustada ao risco."
  },
  {
    "objectID": "aula_2.html#função-de-utilidade-quadrática",
    "href": "aula_2.html#função-de-utilidade-quadrática",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Função de utilidade quadrática",
    "text": "Função de utilidade quadrática\nA função de utilidade quadrática é usada na otimização de portfólios para encontrar a alocação de ativos que maximiza o retorno esperado e minimiza o risco. A função de utilidade quadrática é dada por:\n\\(U = \\mu^T w - \\lambda \\sigma^2\\)\nonde:\n\n\\(U\\) é a função de utilidade\n\\(\\mu^T\\) é o vetor de retornos esperados\n\\(w\\) é o vetor de pesos dos ativos\n\\(\\lambda\\) é o fator de aversão ao risco\n\ngeneralizando para o caso de \\(n\\) ativos, a função de utilidade quadrática é dada por:\n\\(U = \\mu^T w - \\lambda w^T \\Sigma w\\)\nonde:\n\n\\(\\Sigma w\\) é a matriz de covariância dos retornos dos ativos\n\\(w^T\\) é o vetor transposto de pesos dos ativos\n\\(w\\) é o vetor de pesos dos ativos\n\\(\\lambda\\) é o fator de aversão ao risco\n\\(\\mu\\) é o vetor de retornos esperados\n\\(U\\) é a função de utilidade"
  },
  {
    "objectID": "aula_2.html#otimização-de-portfólios",
    "href": "aula_2.html#otimização-de-portfólios",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Otimização de portfólios",
    "text": "Otimização de portfólios\nA otimização de portfólios é um problema de maximização da função de utilidade quadrática sujeita a restrições, como a soma dos pesos dos ativos deve ser igual a 1 e os pesos dos ativos devem ser maiores ou iguais a zero."
  },
  {
    "objectID": "aula_2.html#primeiro-vamos-carregar-os-pacotes-necessários",
    "href": "aula_2.html#primeiro-vamos-carregar-os-pacotes-necessários",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Primeiro vamos carregar os pacotes necessários",
    "text": "Primeiro vamos carregar os pacotes necessários"
  },
  {
    "objectID": "aula_2.html#ativos-selecionados",
    "href": "aula_2.html#ativos-selecionados",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Ativos selecionados",
    "text": "Ativos selecionados\n\n# Ativos selecionados\n\ntickers &lt;- c(\"VALE3.SA\",\"PETR4.SA\",\"AZUL4.SA\",\"MGLU3.SA\", \"CMIG4.SA\")\n\nprices &lt;- \n  getSymbols(tickers, \n             src = 'yahoo', \n             from = \"2019-05-30\",\n             to = \"2024-05-30\",\n             auto.assign = TRUE, #obs auto asign carrega os resultados para o ambiente\n             warnings = FALSE,) %&gt;% \n  map(~Ad(get(.))) %&gt;% \n  reduce(merge) %&gt;%\n  `colnames&lt;-`(tickers)"
  },
  {
    "objectID": "aula_2.html#baixando-os-preços-do-benchmark",
    "href": "aula_2.html#baixando-os-preços-do-benchmark",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Baixando os preços do benchmark",
    "text": "Baixando os preços do benchmark\n\n# Baixando os preços do IBOV\n\nibov &lt;- getSymbols(\"^BVSP\", \n                   src = 'yahoo', \n                   from = \"2019-05-30\",\n                   to = \"2024-05-30\",\n                   auto.assign = TRUE, \n                   warnings = FALSE) %&gt;% \n  map(~Ad(get(.))) %&gt;% \n  reduce(merge) %&gt;% \n  `colnames&lt;-`(\"IBOV\")\n\nhead(ibov)\n\n            IBOV\n2019-05-30 97457\n2019-05-31 97030\n2019-06-03 97020\n2019-06-04 97380\n2019-06-05 95999\n2019-06-06 97205"
  },
  {
    "objectID": "aula_2.html#agora-vamos-converter-os-preços-diários-em-mensais",
    "href": "aula_2.html#agora-vamos-converter-os-preços-diários-em-mensais",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Agora vamos converter os preços diários em mensais",
    "text": "Agora vamos converter os preços diários em mensais\n\nprices_monthly &lt;- to.monthly(prices, indexAt = \"lastof\", OHLC = FALSE)\nhead(prices_monthly)\n\n           VALE3.SA  PETR4.SA AZUL4.SA  MGLU3.SA CMIG4.SA\n2019-05-31 30.86573  8.593929    39.20  56.97055 4.318573\n2019-06-30 32.64209  9.219557    43.29  61.36543 4.344906\n2019-07-31 31.37597  8.772199    51.78  76.65446 4.137171\n2019-08-31 28.70514  8.644517    47.10  84.38617 4.318573\n2019-09-30 30.07835  9.339466    49.71  86.13017 4.192761\n2019-10-31 29.73190 10.302230    52.52 104.00202 3.993803\n\nibov_monthly &lt;- to.monthly(ibov, indexAt = \"lastof\", OHLC = FALSE)\nhead(ibov_monthly)\n\n             IBOV\n2019-05-31  97030\n2019-06-30 100967\n2019-07-31 101812\n2019-08-31 101135\n2019-09-30 104745\n2019-10-31 107220"
  },
  {
    "objectID": "aula_2.html#vamos-calcular-os-retornos-mensais",
    "href": "aula_2.html#vamos-calcular-os-retornos-mensais",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Vamos calcular os retornos mensais",
    "text": "Vamos calcular os retornos mensais\n\nasset_returns_xts &lt;-\n PerformanceAnalytics::Return.calculate(prices_monthly, \n                   method = \"discrete\") %&gt;% \n  na.omit()\n\nibov_returns_xts &lt;- \n  PerformanceAnalytics::Return.calculate(ibov_monthly, \n                   method = \"discrete\") %&gt;% \n  na.omit()\n\nhead(asset_returns_xts)\n\n              VALE3.SA    PETR4.SA    AZUL4.SA    MGLU3.SA     CMIG4.SA\n2019-06-30  0.05755118  0.07279877  0.10433674 0.077142847  0.006097582\n2019-07-31 -0.03878804 -0.04852274  0.19611914 0.249147457 -0.047811281\n2019-08-31 -0.08512360 -0.01455527 -0.09038240 0.100864375  0.043847038\n2019-09-30  0.04783851  0.08039190  0.05541403 0.020666842 -0.029132781\n2019-10-31 -0.01151822  0.10308553  0.05652789 0.207498229 -0.047452887\n2019-11-30  0.05889816 -0.03443148  0.01104337 0.008736587 -0.043955955\n\nhead(ibov_returns_xts)\n\n                   IBOV\n2019-06-30  0.040575080\n2019-07-31  0.008369071\n2019-08-31 -0.006649511\n2019-09-30  0.035694863\n2019-10-31  0.023628813\n2019-11-30  0.009447864"
  },
  {
    "objectID": "aula_2.html#otimização-da-carteira",
    "href": "aula_2.html#otimização-da-carteira",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Otimização da carteira",
    "text": "Otimização da carteira\n\n#| message: false\n\n# Criando o objeto de otimização\n\nportf &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\n# Adicionando restrições, como por exemplo, a soma dos pesos dos ativos deve ser igual a 1\n\nportf &lt;- add.constraint(portf, type = \"full_investment\")\n\n# Adicionando restrição de peso mínimo e máximo para cada ativo\n# Neste caso, o peso mínimo é 0 e o peso máximo é 1\n\nportf &lt;- add.constraint(portf, type = \"long_only\")\n\n\n# Adiciona a função objetivo, que é minimizar o desvio padrão da carteira\n\nportf &lt;- add.objective(portf, type = \"risk\", name = \"StdDev\")\n\n# Resolve o problema de otimização\n\nopt_portf &lt;- optimize.portfolio(asset_returns_xts, portf, optimize_method = \"ROI\")"
  },
  {
    "objectID": "aula_2.html#resultados-da-otimização",
    "href": "aula_2.html#resultados-da-otimização",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Resultados da otimização",
    "text": "Resultados da otimização\n\nopt_portf\n\n***********************************\nPortfolioAnalytics Optimization\n***********************************\n\nCall:\noptimize.portfolio(R = asset_returns_xts, portfolio = portf, \n    optimize_method = \"ROI\")\n\nOptimal Weights:\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n  0.4881   0.0953   0.0000   0.0428   0.3738 \n\nObjective Measure:\n StdDev \n0.07238"
  },
  {
    "objectID": "aula_2.html#extraindo-os-pesos-dos-ativos",
    "href": "aula_2.html#extraindo-os-pesos-dos-ativos",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Extraindo os pesos dos ativos",
    "text": "Extraindo os pesos dos ativos\n\n# extraindo os pesos para um data frame\nweights &lt;- extractWeights(opt_portf)\n\n# Adicionando os nomes dos ativos sem colocá-los no índice\nweights &lt;- data.frame(tickers = colnames(asset_returns_xts), weights, row.names = NULL)\n\nweights\n\n   tickers    weights\n1 VALE3.SA 0.48813406\n2 PETR4.SA 0.09528922\n3 AZUL4.SA 0.00000000\n4 MGLU3.SA 0.04276910\n5 CMIG4.SA 0.37380762"
  },
  {
    "objectID": "aula_2.html#plotando-com-o-portfolioanalytics",
    "href": "aula_2.html#plotando-com-o-portfolioanalytics",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "plotando com o portfolioAnalytics",
    "text": "plotando com o portfolioAnalytics\n\nchart.Weights(opt_portf)"
  },
  {
    "objectID": "aula_2.html#plotando-com-ggplo2",
    "href": "aula_2.html#plotando-com-ggplo2",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Plotando com ggplo2",
    "text": "Plotando com ggplo2\n\nggplot(weights, aes(x = reorder(tickers, weights), y = weights, fill = tickers)) +\n  geom_col(color = \"black\", show.legend = FALSE) +\n  theme_minimal(base_size = 14) +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1),\n    plot.title = element_text(hjust = 0.5, size = 20, face = \"bold\"),\n    plot.subtitle = element_text(hjust = 0.5, size = 16),\n    legend.position = \"none\") +\n  scale_fill_viridis_d() +\n  labs(title = \"Distribuição dos Pesos dos Ativos\",\n   x = \"Ativos\",\n   y = \"Pesos\") +\n  coord_flip()"
  },
  {
    "objectID": "aula_2.html#realizando-otimização-da-função-de-utilidade-com-o-portfolioanalytics",
    "href": "aula_2.html#realizando-otimização-da-função-de-utilidade-com-o-portfolioanalytics",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Realizando otimização da função de utilidade com o PortfolioAnalytics",
    "text": "Realizando otimização da função de utilidade com o PortfolioAnalytics\n\n#criar o objeto de otimização\n\nportf &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\n# Adicionando restrições, como por exemplo, a soma dos pesos dos ativos deve ser igual a 1\n\nportf &lt;- add.constraint(portf, type = \"full_investment\")\n\n# Adicionando restrição de peso mínimo e máximo para cada ativo (0-1)\n\nportf &lt;- add.constraint(portf, type = \"long_only\")\n\n# Adiciona a função objetivo, que é maximizar o retorno esperado\n\nportf &lt;- add.objective(portf, type = \"return\", name = \"mean\")\n\n# Adiciona a função objetivo, que é minimizar a variância da carteira\n\nportf &lt;- add.objective(portf, type = \"risk\", name = \"var\")\n\nportf &lt;- add.objective(portf, type = \"quadratic_utility\", risk_aversion = 10)\n\n# Resolve o problema de otimização\n\nopt_portf &lt;- optimize.portfolio(asset_returns_xts, portf, optimize_method = \"ROI\")\n\n# Extraindo os pesos dos ativos\n\nextractWeights(opt_portf)\n\n   VALE3.SA    PETR4.SA    AZUL4.SA    MGLU3.SA    CMIG4.SA \n0.478117455 0.193940795 0.000000000 0.007504405 0.320437344"
  },
  {
    "objectID": "aula_2.html#pesos",
    "href": "aula_2.html#pesos",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Pesos",
    "text": "Pesos\n\nextractWeights(opt_portf)\n\n   VALE3.SA    PETR4.SA    AZUL4.SA    MGLU3.SA    CMIG4.SA \n0.478117455 0.193940795 0.000000000 0.007504405 0.320437344"
  },
  {
    "objectID": "aula_2.html#entendendo-a-especificação-do-portfólio",
    "href": "aula_2.html#entendendo-a-especificação-do-portfólio",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Entendendo a especificação do portfólio",
    "text": "Entendendo a especificação do portfólio\nO objeto de portfólio é uma lista que contém as seguintes informações:\n\nassets: vetor de nomes dos ativos\nconstraints: lista de restrições\n\nweight_sum: restrição de que a soma dos pesos dos ativos deve ser igual a um valor específico\nfull_investment: restrição de que a soma dos pesos dos ativos deve ser igual a 1\ndollar_neutral: restrição de que a soma dos pesos dos ativos deve ser igual a zero\nbox: restrição de que os pesos dos ativos devem estar dentro de um intervalo específico\nlong_only: restrição de que os pesos dos ativos devem ser maiores ou iguais a zero e menores ou iguais a um (caso especial da restrição box)\ngroup: restrição de que os pesos dos ativos de um grupo específico devem ser iguais\nturnover: restrição de que o turnover da carteira deve ser menor ou igual a um valor específico a partir de uma carteira inicial\ndiversification: Especifica um valor de diversificação para a carteira\nposition_limit: Permite ao usuário definir o número máximo de posições (ativos com pesos não nulos) e o número máximo de posições compradas e vendidas.\nreturn: Especifica o retorno médio esperado da carteira\nfactor_exposure: Especifica a exposição da carteira a fatores de risco\nleverage_exposure: Especifica a alavancagem maxima da carteira onde a alavancagem é definida como a soma dos pesos absolutos dos ativos\n\nobjectives:\n\ntype: ‘return’,‘risk’, ‘risk_budget’, ‘quadratic_utility’, or ’weight_concentration"
  },
  {
    "objectID": "aula_2.html#passo-a-passo-da-otimização-de-portfólios",
    "href": "aula_2.html#passo-a-passo-da-otimização-de-portfólios",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Passo a passo da otimização de portfólios",
    "text": "Passo a passo da otimização de portfólios\n\nCarregar os preços dos ativos e do benchmark\nConverter os preços diários em preços mensais\nCalcular os retornos mensais dos ativos e do benchmark\nCriar o objeto de portfólio\nAdicionar restrições ao objeto de portfólio\nAdicionar a função objetivo ao objeto de portfólio\nResolver o problema de otimização\nExibir os resultados da otimização\nExibir os pesos dos ativos na carteira otimizada\nPlotar a distribuição dos pesos dos ativos na carteira otimizada"
  },
  {
    "objectID": "aula_2.html#criando-um-objeto-para-as-especificações-do-portfólio",
    "href": "aula_2.html#criando-um-objeto-para-as-especificações-do-portfólio",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Criando um objeto para as especificações do portfólio",
    "text": "Criando um objeto para as especificações do portfólio\n\n# Criando o objeto de portfólio, aqui estamos apenas especificando os ativos que serão utilizados na otimização\n\nport_spec &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\nclass(port_spec)\n\n[1] \"portfolio.spec\" \"portfolio\""
  },
  {
    "objectID": "aula_2.html#adicionando-restrições-ao-objeto-de-portfólio",
    "href": "aula_2.html#adicionando-restrições-ao-objeto-de-portfólio",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Adicionando restrições ao objeto de portfólio",
    "text": "Adicionando restrições ao objeto de portfólio\nAs restrições são condições que devem ser satisfeitas durante a otimização da carteira. Algumas restrições comuns são relacionadas ao peso dos ativos e ao retorno esperado da carteira.\n\n# Adicionando restrições, como por exemplo, a soma dos pesos dos ativos deve ser igual a 1\n\nport_spec  &lt;- add.constraint(port_spec, type = \"weight_sum\", min_sum = 1, max_sum = 1)\n\n# adicionnando uma restrição de caixas para os pesos dos ativos\n\nport_spec &lt;- add.constraint(port_spec, type = \"box\", min = c(0.2, 0.1, 0.1, 0.1, 0.1), max = 0.4)\n\n\nport_spec\n\n**************************************************\nPortfolioAnalytics Portfolio Specification \n**************************************************\n\nCall:\nportfolio.spec(assets = colnames(asset_returns_xts))\n\nNumber of assets: 5 \nAsset Names\n[1] \"VALE3.SA\" \"PETR4.SA\" \"AZUL4.SA\" \"MGLU3.SA\" \"CMIG4.SA\"\n\nConstraints\nEnabled constraint types\n        - weight_sum \n        - box"
  },
  {
    "objectID": "aula_2.html#adicionando-a-função-objetivo-ao-objeto-de-portfólio",
    "href": "aula_2.html#adicionando-a-função-objetivo-ao-objeto-de-portfólio",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Adicionando a função objetivo ao objeto de portfólio",
    "text": "Adicionando a função objetivo ao objeto de portfólio\nA função objetivo é a função que será otimizada durante o processo de otimização da carteira. Um objetivo comum é maximizar o retorno esperado da carteira e minimizar a volatilidade e o risco.\nLembre-se que o desvio padrão é a raiz quadrada da variância. E que a variância é a média dos quadrados dos desvios em relação à média. A variancia é geralmente usada para denotar o risco, quanto maior a variancia, maior o risco. Já geralmente denota a volatilidade, quanto maior o desvio padrão, maior a volatilidade. Ambas são medidas que servem como indicadores de risco.\nNo portfolioAnalytics, a função objetivo é adicionada ao objeto de portfólio usando a função add.objective(). Os objetivos mais usado são:\n\nreturn: Maximizar o retorno esperado da carteira\nrisk: Minimizar o risco da carteira\nrisk_budget: Minimizar a contribuição marginal do risco de cada ativo para o risco total da carteira\nquadratic_utility: Maximizar a função de utilidade quadrática da carteira\nweight_concentration: Minimizar a concentração dos pesos dos ativos na carteira\n\n\n# Adiciona a função objetivo, que é maximizar o retorno médio esperado da carteira\n\nport_spec &lt;- add.objective(port_spec, type = \"return\", name = \"mean\")\n\n# Adiciona a função objetivo, que é minimizar o desvio padrão da carteira\n\nport_spec &lt;- add.objective(port_spec, type = \"risk\", name = \"StdDev\")\n\n# Adiciona um objetivo para minimizar a contribuição marginal do risco de cada ativo para o risco total da carteira\n\nport_spec &lt;- add.objective(port_spec, type = \"risk_budget\", name = \"var\", min_prisk = 0.05, max_prisk = 0.1)\n\nprint(port_spec)\n\n**************************************************\nPortfolioAnalytics Portfolio Specification \n**************************************************\n\nCall:\nportfolio.spec(assets = colnames(asset_returns_xts))\n\nNumber of assets: 5 \nAsset Names\n[1] \"VALE3.SA\" \"PETR4.SA\" \"AZUL4.SA\" \"MGLU3.SA\" \"CMIG4.SA\"\n\nConstraints\nEnabled constraint types\n        - weight_sum \n        - box \n\nObjectives:\nEnabled objective names\n        - mean \n        - StdDev \n        - var"
  },
  {
    "objectID": "aula_2.html#resolvendo-o-problema-de-otimização",
    "href": "aula_2.html#resolvendo-o-problema-de-otimização",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Resolvendo o problema de otimização",
    "text": "Resolvendo o problema de otimização\nExistem duas funções principais para resolver o problema de otimização da carteira: optimize.portfolio() e optimize.portfolio.rebalancing(). A função optimize.portfolio() é usada para otimizar a carteira sem rebalanceamento, enquanto a função optimize.portfolio.rebalancing() é usada para otimizar a carteira com rebalanceamento.\nLembre-se que o rebalanceamento é o processo de ajustar os pesos dos ativos na carteira para manter a alocação desejada ao longo do tempo.\nO pacote suporta diversos métodos de otimização, como:\n\nDEoptim: Differential Evolution\nrandom: Random Portfolios\nGenSA: Generalized Simulated Annealing\npso: Particle Swarm Optimization\nROI: R Optimization Infrastructure\n\nO método a ser usado irá depender do problema.\nVamos fazer fazer uma otimização usando o método de portifolios aleatórios. Nosso objetivo é maximizar o retorno esperado da carteira e minimizar o risco onde o risco minimo é 5% e o risco maximo é 10% sujeito a restrições de peso e de grupo.\n\n# .storage &lt;&lt;- new.env()\n\nrp &lt;- random_portfolios(port_spec, permutations = 1000, rp_method = 'simplex')\n\nWarning: executing %dopar% sequentially: no parallel backend registered\n\n# rp &lt;- random_portfolios(port_spec, permutations = 1000, rp_method = 'sample')\n# rp &lt;- random_portfolios(port_spec, permutations = 1000, rp_method = 'grid') \n\nhead(rp)\n\n      VALE3.SA  PETR4.SA  AZUL4.SA  MGLU3.SA  CMIG4.SA\n[1,] 0.2129896 0.1767381 0.3996827 0.1083525 0.1022372\n[2,] 0.2091820 0.1943104 0.1462174 0.1970533 0.2532369\n[3,] 0.2067608 0.1879881 0.1157554 0.1943518 0.2951439\n[4,] 0.2632710 0.1832084 0.2626849 0.1410737 0.1497619\n[5,] 0.2044441 0.2579728 0.1180301 0.3187101 0.1008430\n[6,] 0.2710928 0.1518522 0.3300403 0.1155672 0.1314476\n\n\nSimplex: Distribui pesos aleatoriamente em um espaço triangular, garantindo que a soma seja sempre 1. Sample: Seleciona pesos aleatórios de uma distribuição de probabilidade específica. Grid: Gera pesos em pontos pré-definidos de uma grade regular.\n\nopt  &lt;-  optimize.portfolio(R = asset_returns_xts, port_spec, rp = rp, optimize_method = \"random\", trace = TRUE)\n\nLeverage constraint min_sum and max_sum are restrictive, \n              consider relaxing. e.g. 'full_investment' constraint should be min_sum=0.99 and max_sum=1.01\n\nprint(opt)\n\n***********************************\nPortfolioAnalytics Optimization\n***********************************\n\nCall:\noptimize.portfolio(R = asset_returns_xts, portfolio = port_spec, \n    optimize_method = \"random\", trace = TRUE, rp = rp)\n\nOptimal Weights:\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n  0.3433   0.1313   0.1042   0.1000   0.3213 \n\nObjective Measures:\n   mean \n0.01483 \n\n\n StdDev \n0.08163 \n\ncontribution :\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n 0.01902  0.01069  0.01707  0.01174  0.02311 \n\npct_contrib_StdDev :\nVALE3.SA PETR4.SA AZUL4.SA MGLU3.SA CMIG4.SA \n  0.2330   0.1309   0.2091   0.1439   0.2831"
  },
  {
    "objectID": "aula_2.html#otimizando-a-carteira-com-rebalanceamento",
    "href": "aula_2.html#otimizando-a-carteira-com-rebalanceamento",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Otimizando a carteira com rebalanceamento",
    "text": "Otimizando a carteira com rebalanceamento\nA função optimize.portfolio.rebalancing() é usada para otimizar a carteira com rebalanceamento. O rebalanceamento é o processo de ajustar os pesos dos ativos na carteira para manter a alocação desejada ao longo do tempo. O rebalanceamento é importante para garantir que a carteira permaneça alinhada com os objetivos de investimento (restrições e objetivos) ao longo do tempo.\noptimize.portfolio.rebalancing() suporta otimização de carteiras com rebalanceamento em diferentes janelas de tempo. O backtest é o processo de testar uma estratégia de investimento em dados históricos para avaliar seu desempenho.\nOBS: Dependendo do método de otimização, o processo pode ser demorado.\nExemplo de otimização com rebalanceamento:\n\n# Criar o objeto de portfólio\nport_specr &lt;- portfolio.spec(assets = colnames(asset_returns_xts))\n\n# Adicionar restrições - full investment com soma de pesos igual a 1\n\nport_specr &lt;- add.constraint(port_specr, type = \"long_only\")\n\n# restrição para a soma dos pesos\n\nport_specr &lt;- add.constraint(port_specr, type = \"weight_sum\", min_sum = 0.99, max_sum = 1.01)\n\n# Adicionar a função objetivo - maximizar o retorno esperado\n\nport_specr &lt;- add.objective(port_specr, type = \"return\", name = \"mean\")\n\n# Adicionar a função objetivo - minimizar o risco\n\nport_specr &lt;- add.objective(port_specr, type = \"risk\", name = \"StdDev\")\n\n# Adicionar a função objetivo - minimizar a contribuição marginal do risco de cada ativo para o risco total da carteira\n\nport_specr &lt;- add.objective(port_specr, type = \"risk_budget\", name = \"StdDev\", min_prisk = 0.05, max_prisk = 0.1)\n\nrp &lt;- random_portfolios(port_specr, permutations = 50, rp_method = 'simplex')"
  },
  {
    "objectID": "aula_2.html#otimização",
    "href": "aula_2.html#otimização",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Otimização",
    "text": "Otimização\n\n# Otimização com rebalanceamento mensal\n\nopt_rebal &lt;- optimize.portfolio.rebalancing(R = asset_returns_xts, \n                      portfolio = port_specr, \n                      optimize_method = \"random\",\n                      rp = rp,\n                      trace = TRUE,\n                      search_size = 1000,\n                      rebalance_on = \"months\",\n                      training_period = 12,\n                      rolling_window = 12)\n\nprint(opt_rebal)\n\n**************************************************\nPortfolioAnalytics Optimization with Rebalancing\n**************************************************\n\nCall:\noptimize.portfolio.rebalancing(R = asset_returns_xts, portfolio = port_specr, \n    optimize_method = \"random\", search_size = 1000, trace = TRUE, \n    rp = rp, rebalance_on = \"months\", training_period = 12, rolling_window = 12)\n\nNumber of rebalancing dates:  49 \nFirst rebalance date:\n[1] \"2020-05-31\"\nLast rebalance date:\n[1] \"2024-05-31\"\n\nAnnualized Portfolio Rebalancing Return:\n[1] 0.07826747\n\nAnnualized Portfolio Standard Deviation:\n[1] 0.3166047"
  },
  {
    "objectID": "aula_2.html#analise-dos-resultados",
    "href": "aula_2.html#analise-dos-resultados",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Analise dos resultados",
    "text": "Analise dos resultados\n\nextractObjectiveMeasures(opt_rebal) |&gt; head(1)\n\n                  mean    StdDev StdDev.contribution.VALE3.SA\n2020-05-31 0.007778412 0.1146587                  0.009231419\n           StdDev.contribution.PETR4.SA StdDev.contribution.AZUL4.SA\n2020-05-31                   0.01697412                   0.01598271\n           StdDev.contribution.MGLU3.SA StdDev.contribution.CMIG4.SA\n2020-05-31                   0.02321859                   0.04925188\n           StdDev.pct_contrib_StdDev.VALE3.SA\n2020-05-31                         0.08051214\n           StdDev.pct_contrib_StdDev.PETR4.SA\n2020-05-31                          0.1480404\n           StdDev.pct_contrib_StdDev.AZUL4.SA\n2020-05-31                          0.1393937\n           StdDev.pct_contrib_StdDev.MGLU3.SA\n2020-05-31                          0.2025017\n           StdDev.pct_contrib_StdDev.CMIG4.SA\n2020-05-31                           0.429552\n\nextractWeights(opt_rebal) |&gt; head()\n\n            VALE3.SA  PETR4.SA   AZUL4.SA  MGLU3.SA  CMIG4.SA\n2020-05-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-06-30 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-07-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-08-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-09-30 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n2020-10-31 0.2152079 0.1051845 0.09766879 0.1702039 0.4117349\n\nchart.Weights(opt) \n\n\n\n\n\n\n\nchart.Weights(opt_rebal)"
  },
  {
    "objectID": "aula_2.html#plotando-os-pesos-ao-longo-do-tempo-com-ggplot2",
    "href": "aula_2.html#plotando-os-pesos-ao-longo-do-tempo-com-ggplot2",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Plotando os pesos ao longo do tempo com ggplot2",
    "text": "Plotando os pesos ao longo do tempo com ggplot2\n\n# Extraindo os pesos dos ativos ao longo do tempo\n\nweights_xts &lt;- extractWeights(opt_rebal)\n\n# Convertendo os pesos para um data frame\n\nweights_df &lt;- weights_xts %&gt;% \n              tk_tbl(preserve_index = TRUE, rename_index = \"Date\")\n\n\n# Colocando o data frame em formato longo\n\nweights_long_df &lt;- weights_df %&gt;% \n                pivot_longer(cols = -Date, names_to = \"Asset\", values_to = \"Weight\")\n\n\nplotly::ggplotly(ggplot(weights_long_df) +\n  aes(x = Date, y = Weight, colour = Asset) +\n  geom_smooth(se = FALSE ) +\n  scale_fill_hue(direction = 1) +\n  labs(\n    x = \"Data\",\n    y = \"Peso\",\n    title = \"Peso dos ativos rebalanceados ao longo do tempo\",\n    colour = \"Ativos\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 16L,\n    face = \"bold\",\n    hjust = 0.5)\n  )\n)\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'"
  },
  {
    "objectID": "aula_2.html#plotando-o-retorno-do-portfólio-ao-longo-do-tempo",
    "href": "aula_2.html#plotando-o-retorno-do-portfólio-ao-longo-do-tempo",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Plotando o retorno do portfólio ao longo do tempo",
    "text": "Plotando o retorno do portfólio ao longo do tempo\n\n# Calculando o retorno do portfólio otimizado e adicionando o retorno do IBOV\nopt_returns_long_df &lt;- Return.portfolio(R = asset_returns_xts, weights = extractWeights(opt_rebal)) %&gt;%\n  tk_tbl(preserve_index = TRUE, rename_index = \"Date\") %&gt;%\n  inner_join(ibov_returns_xts %&gt;% tk_tbl(preserve_index = TRUE, rename_index = \"Date\"), by = \"Date\", suffix = c(\"_Portfolio\", \"_IBOV\")) %&gt;%\n  pivot_longer(cols = -Date, names_to = \"Portfolio\", values_to = \"Return\")\n\nplotly::ggplotly(ggplot(opt_returns_long_df) +\n  aes(x = Date, y = Return, colour = Portfolio) +\n  geom_line() +\n  scale_fill_hue(direction = 1) +\n  labs(\n    x = \"Data\",\n    y = \"Retorno\",\n    title = \"Retorno do portifólio vs IBOV ao longo do tempo\",\n    colour = \"Portfólio\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 16L,\n    face = \"bold\",\n    hjust = 0.5)\n  )\n)"
  },
  {
    "objectID": "aula_2.html#bonus-plotando-a-fronteira-eficiente",
    "href": "aula_2.html#bonus-plotando-a-fronteira-eficiente",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Bonus: Plotando a fronteira eficiente",
    "text": "Bonus: Plotando a fronteira eficiente\nA fronteira eficiente é uma curva que mostra a combinação ótima de ativos em uma carteira que maximiza o retorno esperado para um determinado nível de risco. Note que o indice de Sharpe é a inclinação da linha tangente a fronteira eficiente, o intercepto com o eixo y é o retorno livre de risco e o ponto de tangência é o ponto com o maior indice de Sharpe.\n\n# Calculando a fronteira eficiente\nfrontier &lt;- create.EfficientFrontier(R = asset_returns_xts, portfolio = port_spec, type = \"mean-StdDev\")\n\n# Plotando a fronteira eficiente\nchart.EfficientFrontier(frontier, match.col = \"StdDev\",n.portfolios = 30, main = \"Fronteira eficiente\")"
  },
  {
    "objectID": "aula_2.html#dashboards-interativos-com-quarto",
    "href": "aula_2.html#dashboards-interativos-com-quarto",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Dashboards interativos com QUARTO",
    "text": "Dashboards interativos com QUARTO\nClique aqui!!"
  },
  {
    "objectID": "aula_2.html#exercício",
    "href": "aula_2.html#exercício",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Exercício",
    "text": "Exercício\n\nCrie uma carteira com 5 ativos de sua escolha\nBaixe os preços dos ativos\nCalcule os retornos mensais\nCrie um vetor de pesos para a carteira\nCalcule o retorno da carteira\nFaça a otimização da carteira com o objetivo de maximizar o retorno esperado e minimizar o risco\nOpcionalmente faça a otimização com rebalanceamento\nVisualize o retorno da carteira e dos ativos\nCompare o retorno da carteira com o índice do mercado\nSalve o seu dashboard e compartilhe com o professor"
  },
  {
    "objectID": "aula_2.html#dica-use-o-arquivo-das-aulas-anteriores-como-referência-para-criar-o-seu-dashboard",
    "href": "aula_2.html#dica-use-o-arquivo-das-aulas-anteriores-como-referência-para-criar-o-seu-dashboard",
    "title": "Aula 2 - Análise e otimização de carteiras",
    "section": "Dica: Use o arquivo das aulas anteriores como referência para criar o seu dashboard",
    "text": "Dica: Use o arquivo das aulas anteriores como referência para criar o seu dashboard"
  },
  {
    "objectID": "aula_1.html",
    "href": "aula_1.html",
    "title": "Aula 1",
    "section": "",
    "text": "Criar um novo projeto no RStudio cloud (ou posit cloud)\nCriar um documento QUARTO\nCriar um portifólio com 5 ativos ou mais (consultar no yahoo finance)\nBaixar os dados de preço\nVisualizar o gráfico de preços mensais dos ativos\nCalcular e visualizar os retornos mensais\nExplorar outras funções (se der tempo)"
  },
  {
    "objectID": "aula_1.html#trabalhando-com-um-portifólio-ou-carteira",
    "href": "aula_1.html#trabalhando-com-um-portifólio-ou-carteira",
    "title": "Aula 1",
    "section": "",
    "text": "Criar um novo projeto no RStudio cloud (ou posit cloud)\nCriar um documento QUARTO\nCriar um portifólio com 5 ativos ou mais (consultar no yahoo finance)\nBaixar os dados de preço\nVisualizar o gráfico de preços mensais dos ativos\nCalcular e visualizar os retornos mensais\nExplorar outras funções (se der tempo)"
  },
  {
    "objectID": "aula_1.html#antes-de-mais-nada-vamos-carregar-os-pacotes-que-serão-usados",
    "href": "aula_1.html#antes-de-mais-nada-vamos-carregar-os-pacotes-que-serão-usados",
    "title": "Aula 1",
    "section": "Antes de mais nada, vamos carregar os pacotes que serão usados",
    "text": "Antes de mais nada, vamos carregar os pacotes que serão usados\n\nlibrary(tidyverse)\nlibrary(quantmod)\nlibrary(PerformanceAnalytics)\nlibrary(timetk)#preguiça"
  },
  {
    "objectID": "aula_1.html#vamos-criar-nossa-carteira",
    "href": "aula_1.html#vamos-criar-nossa-carteira",
    "title": "Aula 1",
    "section": "Vamos criar nossa carteira",
    "text": "Vamos criar nossa carteira\nvá ate o site yahoo finance( https://finance.yahoo.com/) e selecione 5 ativos de sua preferencia.\n\nPesquise cada uma dessas empresas no site\ncopie o simbolo(ticker) de cada uma e crie um vetor num chunk do seu documento.\n\n\n\n\n\n\n\nTip\n\n\n\nLembre-se, você pode adicionar um novo trecho de código com o atalho!\n\n\nEu vou escolher as seguintes empresas:\nVale, Petrobras, Azul e Magazine Luiza\n\ntickers &lt;- c(\"VALE3.SA\",\"PETR4.SA\",\"AZUL4.SA\",\"MGLU3.SA\",\"^BVSP\")"
  },
  {
    "objectID": "aula_1.html#vamos-baixar-os-preços-dentro-de-um-periodo-usando-o-pacote-quantmod",
    "href": "aula_1.html#vamos-baixar-os-preços-dentro-de-um-periodo-usando-o-pacote-quantmod",
    "title": "Aula 1",
    "section": "Vamos baixar os preços dentro de um periodo usando o pacote quantmod",
    "text": "Vamos baixar os preços dentro de um periodo usando o pacote quantmod\n\nprices &lt;- \n  getSymbols(tickers, \n             src = 'yahoo', \n             from = \"2020-01-01\",\n             to = \"2023-05-30\",\n             auto.assign = TRUE, #obs auto asign carrega os resultados para o ambiente\n             warnings = FALSE,) %&gt;% \n  map(~Ad(get(.))) %&gt;% \n  reduce(merge) %&gt;%\n  `colnames&lt;-`(tickers)\n\nhead(prices)\n\n           VALE3.SA PETR4.SA AZUL4.SA MGLU3.SA  ^BVSP\n2020-01-02 35.13004 10.62144    58.80 115.0151 118573\n2020-01-03 34.87139 10.53494    56.76 113.9892 117707\n2020-01-06 34.66448 10.65950    55.00 114.0824 116878\n2020-01-07 34.91665 10.61798    56.82 113.7560 116662\n2020-01-08 34.92312 10.55224    56.92 117.2533 116247\n2020-01-09 34.46403 10.51765    57.28 121.4268 115947\n\nclass(prices)\n\n[1] \"xts\" \"zoo\""
  },
  {
    "objectID": "aula_1.html#agora-vamos-converter-os-preços-diários-em-mensais",
    "href": "aula_1.html#agora-vamos-converter-os-preços-diários-em-mensais",
    "title": "Aula 1",
    "section": "Agora vamos converter os preços diários em mensais",
    "text": "Agora vamos converter os preços diários em mensais\n\nprices_monthly &lt;- to.monthly(prices, indexAt = \"lastof\", OHLC = FALSE)\nhead(prices_monthly)\n\n           VALE3.SA PETR4.SA AZUL4.SA  MGLU3.SA  ^BVSP\n2020-01-31 32.50481 9.842996    59.26 130.10014 113761\n2020-02-29 28.65105 8.767012    44.44 117.78960 104172\n2020-03-31 27.94625 4.840193    17.55  90.90689  73020\n2020-04-30 29.00669 6.244852    17.40 115.87772  80506\n2020-05-31 34.27005 7.037136    14.28 150.03484  87403\n2020-06-30 36.15813 7.455764    20.11 167.05510  95056"
  },
  {
    "objectID": "aula_1.html#podemos-agora-calcular-os-retornos",
    "href": "aula_1.html#podemos-agora-calcular-os-retornos",
    "title": "Aula 1",
    "section": "Podemos agora calcular os retornos",
    "text": "Podemos agora calcular os retornos\nPodemos calcular o retorno linear: \\[ Retorno\\,linear = \\frac{Preço_{final}-Preço_{inicial}}{Preço_{inicial}}\\]\nOu Logarítmico: \\[ Log\\,Retorno = \\ln(\\frac{Preço_{final}}{Preço_{inicial}})\\]\nNormalmente o retorno logarítmico é usado em series temporais mais longas, enquanto o retorno linear é mais usado para calcular a variação dos preços em períodos menores. Vamos usar o retorno linear no nosso estudo.\n\nasset_returns_xts &lt;-\n PerformanceAnalytics::Return.calculate(prices_monthly, \n                   method = \"discrete\") %&gt;% \n  na.omit()\nhead(asset_returns_xts)\n\n              VALE3.SA    PETR4.SA     AZUL4.SA    MGLU3.SA       ^BVSP\n2020-02-29 -0.11855972 -0.10931469 -0.250084376 -0.09462362 -0.08429075\n2020-03-31 -0.02459950 -0.44790842 -0.605085514 -0.22822649 -0.29904389\n2020-04-30  0.03794563  0.29020717 -0.008546987  0.27468581  0.10251986\n2020-05-31  0.18145335  0.12686986 -0.179310342  0.29476858  0.08567063\n2020-06-30  0.05509419  0.05948844  0.408263374  0.11344208  0.08755992\n2020-07-31  0.08565810  0.03018342  0.009945244  0.12772308  0.08264602\n\nsummary(asset_returns_xts)\n\n     Index               VALE3.SA           PETR4.SA           AZUL4.SA        \n Min.   :2020-02-29   Min.   :-0.14715   Min.   :-0.44791   Min.   :-0.605086  \n 1st Qu.:2020-12-23   1st Qu.:-0.06259   1st Qu.:-0.04695   1st Qu.:-0.104400  \n Median :2021-10-15   Median : 0.02811   Median : 0.02163   Median :-0.032531  \n Mean   :2021-10-15   Mean   : 0.01973   Mean   : 0.02799   Mean   : 0.001149  \n 3rd Qu.:2022-08-07   3rd Qu.: 0.07765   3rd Qu.: 0.11125   3rd Qu.: 0.080608  \n Max.   :2023-05-31   Max.   : 0.28819   Max.   : 0.31468   Max.   : 0.687237  \n    MGLU3.SA            ^BVSP          \n Min.   :-0.37097   Min.   :-0.299044  \n 1st Qu.:-0.16961   1st Qu.:-0.035680  \n Median :-0.02788   Median : 0.005701  \n Mean   :-0.01113   Mean   : 0.002558  \n 3rd Qu.: 0.10304   3rd Qu.: 0.060130  \n Max.   : 0.65504   Max.   : 0.158975"
  },
  {
    "objectID": "aula_1.html#ahhh-mas-eu-nao-sei-usar-o-ggplot-é-muito-dificil",
    "href": "aula_1.html#ahhh-mas-eu-nao-sei-usar-o-ggplot-é-muito-dificil",
    "title": "Aula 1",
    "section": "Ahhh mas eu nao sei usar o ggplot, é muito dificil 🥲",
    "text": "Ahhh mas eu nao sei usar o ggplot, é muito dificil 🥲"
  },
  {
    "objectID": "aula_1.html#seus-problemas-acabaram",
    "href": "aula_1.html#seus-problemas-acabaram",
    "title": "Aula 1",
    "section": "SEUS PROBLEMAS ACABARAM!",
    "text": "SEUS PROBLEMAS ACABARAM!"
  },
  {
    "objectID": "aula_1.html#com-esquisse-você-plota-gráficos-com-o-ggplot2-sem-saber-nada-de-ggplot2",
    "href": "aula_1.html#com-esquisse-você-plota-gráficos-com-o-ggplot2-sem-saber-nada-de-ggplot2",
    "title": "Aula 1",
    "section": "Com esquisse você plota gráficos com o ggplot2 sem saber nada de ggplot2 😁",
    "text": "Com esquisse você plota gráficos com o ggplot2 sem saber nada de ggplot2 😁\nTente rodar o codigo a seguir\n\nesquisse::esquisser(asset_returns_tbl)\n\nVamos testar ao vivo! Voltamos em Breve…"
  },
  {
    "objectID": "aula_1.html#voltando-vamos-dar-peso-às-nossas-escolhas",
    "href": "aula_1.html#voltando-vamos-dar-peso-às-nossas-escolhas",
    "title": "Aula 1",
    "section": "Voltando… vamos dar peso às nossas escolhas",
    "text": "Voltando… vamos dar peso às nossas escolhas\nVamos criar um vetor de pesos para os nossos ativos, ele vai ser importante quando formos calcular os retornos da nossa carteira. Vamos chamar esse vetor de w.\n\nw &lt;- c(0.25,0.25,0.20,0.20,0.10)\n\nsum(w)\n\n[1] 1\n\n\n\n\n\n\n\n\nAtenção!!\n\n\n\nA soma dos pesos da carteira deverá ser sempre igual a 100%, ou seja 1.\n\n\nO cálculo do retorno de uma carteira depende do retorno de cada ativo e de seu peso na carteira e pode ser obtido pela média ponderada:\n\\[ \\bar{k}=\\sum_{i=i}^n{w_i*k_i}\\]"
  },
  {
    "objectID": "aula_1.html#vamos-usar-o-performanceanlytics-para-obter-o-retorno-do-portifólio-e-visualizar-rapidamente-com-a-função-plot-nativa-do-r",
    "href": "aula_1.html#vamos-usar-o-performanceanlytics-para-obter-o-retorno-do-portifólio-e-visualizar-rapidamente-com-a-função-plot-nativa-do-r",
    "title": "Aula 1",
    "section": "Vamos usar o PerformanceAnlytics para obter o retorno do portifólio e visualizar rapidamente com a função plot, nativa do R",
    "text": "Vamos usar o PerformanceAnlytics para obter o retorno do portifólio e visualizar rapidamente com a função plot, nativa do R\n\nportfolio_returns_xts&lt;-Return.portfolio(asset_returns_xts,\n                 weights = w,\n                 rebalance_on = \"months\",\n                 type= \"discrete\") %&gt;% \n  `colnames&lt;-`(\"CARTEIRA\")\nhead(portfolio_returns_xts,3)\n\n             CARTEIRA\n2020-02-29 -0.1343393\n2020-03-31 -0.3146938\n2020-04-30  0.1455180\n\nplot(portfolio_returns_xts)"
  },
  {
    "objectID": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-ativos",
    "href": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-ativos",
    "title": "Aula 1",
    "section": "Agora vamos visualizar nossa carteira VS Ativos",
    "text": "Agora vamos visualizar nossa carteira VS Ativos\nPara isso vamos precisar criar m novo data frame com as duas variáveis.\n\ncomparação &lt;- cbind(asset_returns_xts,portfolio_returns_xts) %&gt;% \n  tk_tbl(rename_index = \"Data\") %&gt;% \n  pivot_longer(!\"Data\" ,names_to = \"assets\")\n\nplotly::ggplotly(ggplot(comparação) +\n  aes(x = Data, y = value, colour = assets) +\n  geom_line() +\n  scale_color_hue(direction = 1) +\n  labs(title = \"Retornos de 2020 a 2023 + Retorno da carteira\")+ \n  theme_minimal())"
  },
  {
    "objectID": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-índice-do-mercado",
    "href": "aula_1.html#agora-vamos-visualizar-nossa-carteira-vs-índice-do-mercado",
    "title": "Aula 1",
    "section": "Agora vamos visualizar nossa carteira VS Índice do mercado",
    "text": "Agora vamos visualizar nossa carteira VS Índice do mercado\n\nplotly::ggplotly(comparação %&gt;%\n filter(assets %in% c(\"X.BVSP\", \"CARTEIRA\")) %&gt;%\n ggplot() +\n  aes(x = Data, y = value, colour = assets) +\n  geom_line() +\n  scale_color_hue(direction = 1) +\n  labs(title = \"Carteira VS Índice do mercado - 2020 - 2023\")+\n  theme_minimal())"
  }
]